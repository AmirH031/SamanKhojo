import{c as K,u as Oe,j as e,S as De,a as Z,b as xe,U as ss,L as Ue,d as U,g as G,e as Y,f as Se,h as ts,r as rs,i as as,X as ae,M as Ce,P as is,k as ye,E as fe,l as Ee,m as ns,n as ls,o as os,p as cs,q as re,G as ds,s as ms,t as he,F as He,A as de,C as ue,v as ze,w as J,x as xs,y as hs,z as us,B as gs,D as ps,H as bs,I as ys,J as fs,K as Re,T as ge,N as se,O as vs}from"./index-CoRpFcO_.js";import{r as h}from"./vendor-ByojS96y.js";import{m as T,A as oe}from"./ui-JBksMQam.js";import{toast as p}from"./utils-dW3-0Dkj.js";import{y as Q,z as Ve,I as pe,B as le,K as Le,s as W,m as ne,o as ve,J as We,L as js,n as Ns}from"./firebase-CHM_3GU8.js";import{P as ie}from"./plus-BcViIRHA.js";import{T as je}from"./trash-2-_XehuA33.js";import{T as Be}from"./tag-DCFC4n7Q.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=K("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=K("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=K("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=K("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=K("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=K("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=K("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=K("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=K("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]),Ss=({children:s,title:i,subtitle:a})=>{const{user:m,logout:c}=Oe(),[b,y]=h.useState(!1),k=async()=>{try{await c()}catch(g){console.error("Logout error:",g)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 relative overflow-hidden",children:[e.jsxs("div",{className:"fixed inset-0 -z-10",children:[e.jsx("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-gradient-to-br from-violet-200/40 to-purple-200/40 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute bottom-0 right-1/4 w-96 h-96 bg-gradient-to-br from-blue-200/40 to-cyan-200/40 rounded-full blur-3xl animate-pulse",style:{animationDelay:"2s"}}),e.jsx("div",{className:"absolute top-1/2 left-0 w-64 h-64 bg-gradient-to-br from-pink-200/30 to-rose-200/30 rounded-full blur-3xl animate-pulse",style:{animationDelay:"4s"}})]}),e.jsxs(T.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"relative bg-white/95 backdrop-blur-2xl border-b border-white/40 sticky top-0 z-50 shadow-2xl",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-violet-500/5 via-purple-500/5 to-indigo-500/5"}),e.jsx("div",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16 sm:h-20 py-3 sm:py-4",children:[e.jsxs(T.div,{className:"flex items-center space-x-4",whileHover:{scale:1.02},children:[e.jsxs("div",{className:"relative",children:[e.jsx(T.div,{className:"bg-gradient-to-r from-violet-600 via-purple-600 to-indigo-600 p-3 rounded-2xl shadow-lg",whileHover:{rotate:360},transition:{duration:.8},children:e.jsx(ws,{className:"text-white w-5 h-5 sm:w-7 sm:h-7"})}),e.jsx("div",{className:"absolute -top-1 -right-1",children:e.jsx(De,{className:"text-yellow-400",size:16})})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-black bg-gradient-to-r from-violet-600 via-purple-600 to-indigo-600 bg-clip-text text-transparent",children:i}),a&&e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1 font-medium hidden sm:block",children:a})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[e.jsx("div",{className:"hidden md:block relative",children:e.jsxs(T.div,{whileHover:{scale:1.02},className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search anything...",className:"w-64 bg-white/80 backdrop-blur-sm border border-white/40 rounded-2xl px-4 py-2 pl-10 text-sm focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent transition-all duration-300"}),e.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"})]})}),e.jsx(T.button,{whileHover:{scale:1.1,rotate:90},whileTap:{scale:.9},className:"p-3 text-gray-600 hover:text-indigo-600 hover:bg-indigo-50 rounded-2xl transition-all duration-300",children:e.jsx(xe,{size:22})}),e.jsxs("div",{className:"relative",children:[e.jsxs(T.button,{onClick:()=>y(!b),whileHover:{scale:1.05},whileTap:{scale:.95},className:"flex items-center space-x-3 bg-gradient-to-r from-gray-50/80 to-white/80 backdrop-blur-sm rounded-2xl px-4 py-3 hover:shadow-lg transition-all duration-300 border border-gray-200/50",children:[e.jsx("div",{className:"bg-gradient-to-r from-violet-500 to-purple-600 p-2 rounded-xl shadow-lg",children:e.jsx(ss,{className:"text-white",size:18})}),e.jsxs("div",{className:"text-left hidden sm:block",children:[e.jsx("p",{className:"text-sm font-bold text-gray-900",children:"Dashboard"}),e.jsx("p",{className:"text-xs text-gray-600 truncate max-w-32",children:"Management Panel"})]})]}),e.jsx(oe,{children:b&&e.jsxs(T.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},className:"absolute right-0 top-full mt-2 w-48 bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/40 p-2 z-50",children:[e.jsx("button",{className:"w-full text-left p-3 rounded-xl hover:bg-gray-100/80 transition-all text-sm font-medium text-gray-700",children:"Profile Settings"}),e.jsx("button",{className:"w-full text-left p-3 rounded-xl hover:bg-gray-100/80 transition-all text-sm font-medium text-gray-700",children:"Preferences"}),e.jsx("hr",{className:"my-2 border-gray-200"}),e.jsx("button",{onClick:k,className:"w-full text-left p-3 rounded-xl hover:bg-red-50 transition-all text-sm font-medium text-red-600",children:"Sign Out"})]})})]}),e.jsxs(T.button,{onClick:k,whileHover:{scale:1.05},whileTap:{scale:.95},className:"flex items-center space-x-2 bg-gradient-to-r from-red-500 to-pink-600 text-white hover:from-red-600 hover:to-pink-700 px-4 py-3 rounded-2xl transition-all duration-300 shadow-lg hover:shadow-xl font-medium",children:[e.jsx(Ue,{size:18}),e.jsx("span",{className:"text-sm hidden sm:inline",children:"Logout"})]})]})]})})]}),e.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,type:"spring",bounce:.3},className:"relative z-10",children:s})}),b&&e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>{y(!1)}})]})},Ke=()=>Je.map((s,i)=>({id:`fallback-${i}`,...s,sortOrder:i+1,isActive:s.isActive??!0,createdAt:{toDate:()=>new Date},updatedAt:{toDate:()=>new Date}})),Je=[{name:"Kirana / General Store",hindi_name:"рдХрд┐рд░рд╛рдирд╛ / рдЬрдирд░рд▓ рд╕реНрдЯреЛрд░",icon:"ЁЯЫТ",isActive:!0},{name:"Fruits & Vegetables (Sabzi Mandi)",hindi_name:"рдлрд▓ рдФрд░ рд╕рдмреНрдЬреА (рд╕рдмреНрдЬреА рдордВрдбреА)",icon:"ЁЯем",isActive:!0},{name:"Dairy & Bakery",hindi_name:"рдбреЗрдпрд░реА рдФрд░ рдмреЗрдХрд░реА",icon:"ЁЯеЫ",isActive:!0},{name:"Stationery & Printing",hindi_name:"рд╕реНрдЯреЗрд╢рдирд░реА рдФрд░ рдкреНрд░рд┐рдВрдЯрд┐рдВрдЧ",icon:"ЁЯУЭ",isActive:!0},{name:"Cosmetics & Personal Care",hindi_name:"рдХреЙрд╕реНрдореЗрдЯрд┐рдХреНрд╕ рдФрд░ рд╡реНрдпрдХреНрддрд┐рдЧрдд рджреЗрдЦрднрд╛рд▓",icon:"ЁЯТД",isActive:!0},{name:"Clothing & Garments",hindi_name:"рдХрдкрдбрд╝реЗ рдФрд░ рд╡рд╕реНрддреНрд░",icon:"ЁЯСХ",isActive:!0},{name:"Footwear & Bags",hindi_name:"рдЬреВрддреЗ рдФрд░ рдмреИрдЧ",icon:"ЁЯСЯ",isActive:!0},{name:"Electronics & Mobile",hindi_name:"рдЗрд▓реЗрдХреНрдЯреНрд░реЙрдирд┐рдХреНрд╕ рдФрд░ рдореЛрдмрд╛рдЗрд▓",icon:"ЁЯУ▒",isActive:!0},{name:"Jewellery & Imitation",hindi_name:"рдЖрднреВрд╖рдг рдФрд░ рдирдХрд▓реА",icon:"ЁЯТН",isActive:!0},{name:"Medical & Healthcare",hindi_name:"рдЪрд┐рдХрд┐рддреНрд╕рд╛ рдФрд░ рд╕реНрд╡рд╛рд╕реНрдереНрдп рд╕реЗрд╡рд╛",icon:"ЁЯПе",isActive:!0},{name:"Furniture & Home Needs",hindi_name:"рдлрд░реНрдиреАрдЪрд░ рдФрд░ рдШрд░реЗрд▓реВ рдЬрд░реВрд░рддреЗрдВ",icon:"ЁЯкС",isActive:!0},{name:"Hardware & Building Material",hindi_name:"рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдФрд░ рдирд┐рд░реНрдорд╛рдг рд╕рд╛рдордЧреНрд░реА",icon:"ЁЯФи",isActive:!0},{name:"Sports & Toys",hindi_name:"рдЦреЗрд▓ рдФрд░ рдЦрд┐рд▓реМрдиреЗ",icon:"тЪ╜",isActive:!0},{name:"Sweet Shops (Mithai)",hindi_name:"рдорд┐рдард╛рдИ рдХреА рджреБрдХрд╛рди",icon:"ЁЯНм",isActive:!0},{name:"Meat / Fish / Chicken / Eggs",hindi_name:"рдорд╛рдВрд╕ / рдордЫрд▓реА / рдЪрд┐рдХрди / рдЕрдВрдбреЗ",icon:"ЁЯНЦ",isActive:!0},{name:"Tailor / Laundry / Boutique",hindi_name:"рджрд░реНрдЬреА / рдзреБрд▓рд╛рдИ / рдмреБрдЯреАрдХ",icon:"тЬВя╕П",isActive:!0},{name:"Gift & Decoration",hindi_name:"рдЙрдкрд╣рд╛рд░ рдФрд░ рд╕рдЬрд╛рд╡рдЯ",icon:"ЁЯОБ",isActive:!0}],we=async()=>{try{const s=Q(U,"categories"),i=Ve(s,pe("sortOrder"),pe("name"));return(await le(i)).docs.map(m=>({id:m.id,...m.data()}))}catch(s){return console.error("Error fetching categories from Firestore:",s),console.log("Using fallback categories due to permission error"),Ke()}},ke=async()=>{try{return(await we()).filter(i=>i.isActive)}catch(s){return console.error("Error fetching active categories:",s),Ke()}},Cs=async s=>{try{if(!(await G()).isAdmin)throw new Error("Admin access required");if(!s.name||!s.name.trim())throw new Error("Category name is required");const a=await we(),m=a.length>0?Math.max(...a.map(y=>y.sortOrder)):0,c=Q(U,"categories");return(await Le(c,{...s,sortOrder:s.sortOrder??m+1,isActive:s.isActive??!0,createdAt:W(),updatedAt:W()})).id}catch(i){throw console.error("Error adding category:",i),i}},me=async(s,i)=>{try{if(!(await G()).isAdmin)throw new Error("Admin access required");const m=Object.fromEntries(Object.entries(i).filter(([b,y])=>y!==void 0)),c=ne(U,"categories",s);await ve(c,{...m,updatedAt:W()})}catch(a){throw console.error("Error updating category:",a),a}},As=async s=>{try{if(!(await G()).isAdmin)throw new Error("Admin access required");const a=ne(U,"categories",s);await We(a)}catch(i){throw console.error("Error deleting category:",i),i}},Is=async()=>{try{if(!(await G()).isAdmin)throw new Error("Admin access required");const i=await we();if(i.length>0&&!i[0].id.startsWith("fallback-")){console.log("Categories already exist, skipping initialization");return}const a=Q(U,"categories"),m=Je.map((c,b)=>Le(a,{...c,sortOrder:b+1,createdAt:W(),updatedAt:W()}));await Promise.all(m),console.log("Default categories initialized successfully")}catch(s){throw console.error("Error initializing default categories:",s),s.code==="permission-denied"?new Error("Permission denied. Please check Firestore security rules for the categories collection."):s}},Ts=s=>{const i=[];return(!s.name||!s.name.trim())&&i.push("Category name is required"),s.name&&s.name.length>100&&i.push("Category name must be less than 100 characters"),s.hindi_name&&s.hindi_name.length>100&&i.push("Hindi name must be less than 100 characters"),s.description&&s.description.length>500&&i.push("Description must be less than 500 characters"),s.sortOrder!==void 0&&(s.sortOrder<0||!Number.isInteger(s.sortOrder))&&i.push("Sort order must be a positive integer"),i},Te=async()=>{try{console.log("Starting shop category validation...");const[s,i]=await Promise.all([Y(!0),ke()]),a=i.map(c=>c.name.toLowerCase());let m=0;for(const c of s){let b=!1,y={};if(c.type){const k=c.type.trim(),g=i.find(E=>E.name.toLowerCase()===k.toLowerCase());g&&c.type!==g.name&&(y.type=g.name,b=!0)}if(b)try{await Se(c.id,y),m++,console.log(`Updated shop ${c.shopName} category to: ${y.type}`)}catch(k){console.error(`Failed to update shop ${c.shopName}:`,k)}}console.log(`Shop category validation completed. Updated ${m} shops.`)}catch(s){throw console.error("Error validating shop categories:",s),s}},Qe=async()=>{try{const s=await Y(),i=new Set;return s.forEach(a=>{a.type&&a.type.trim()&&i.add(a.type.trim())}),Array.from(i).sort()}catch(s){return console.error("Error getting shop categories:",s),[]}},Ds=async s=>{try{const[i,a]=await Promise.all([ke(),Qe()]),m=[...i.map(y=>y.name),...a],c=Array.from(new Set(m));if(!s||!s.trim())return c.sort();const b=s.toLowerCase();return c.filter(y=>y.toLowerCase().includes(b)).sort()}catch(i){return console.error("Error getting category suggestions:",i),[]}},Es=({isOpen:s,onClose:i,onSuccess:a})=>{const[m,c]=h.useState(!1),[b,y]=h.useState(!1),k=async()=>{c(!0);try{await rs()?(p.success("Admin permissions refreshed successfully!"),a(),i()):p.error("No admin permissions found. Please contact the system administrator.")}catch(E){console.error("Error refreshing admin claims:",E),p.error("Failed to refresh permissions. Please try signing out and back in.")}finally{c(!1)}},g=async()=>{y(!0);try{await js(as),p.info("Signed out successfully. Please sign back in with your admin account."),i()}catch(E){console.error("Error signing out:",E),p.error("Failed to sign out. Please try again.")}finally{y(!1)}};return s?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(T.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-2xl p-6 max-w-md w-full shadow-xl",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ts,{className:"w-8 h-8 text-orange-600"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Admin Permissions Required"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Your admin permissions need to be refreshed. This happens when admin claims are newly assigned to your account."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:k,disabled:m||b,className:"w-full flex items-center justify-center space-x-2 bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[m?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):e.jsx(be,{size:18}),e.jsx("span",{children:m?"Refreshing...":"Refresh Permissions"})]}),e.jsxs("button",{onClick:g,disabled:m||b,className:"w-full flex items-center justify-center space-x-2 bg-gray-600 text-white py-3 px-4 rounded-lg hover:bg-gray-700 transition-colors disabled:opacity-50",children:[b?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):e.jsx(Ue,{size:18}),e.jsx("span",{children:b?"Signing Out...":"Sign Out & Sign Back In"})]}),e.jsx("button",{onClick:i,disabled:m||b,className:"w-full py-3 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"})]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:e.jsxs("p",{className:"text-xs text-blue-700",children:[e.jsx("strong",{children:"Note:"})," If refreshing doesn't work, signing out and back in will definitely resolve the issue."]})})]})}):null},qe=s=>{if(!s)return"";const[i,a]=s.split(":"),m=parseInt(i),c=m>=12?"PM":"AM";return`${m%12||12}:${a} ${c}`},zs=()=>{const[s,i]=h.useState([]),[a,m]=h.useState([]),[c,b]=h.useState([]),[y,k]=h.useState(!0),[g,E]=h.useState(!1),[z,I]=h.useState(null),[d,D]=h.useState({shopName:"",hindi_shopName:"",ownerName:"",type:"",shopType:"product",serviceDetails:[],address:"",phone:"",openingTime:"",closingTime:"",mapLink:"",isOpen:!0,isFeatured:!1,isVerified:!1,isHidden:!1,location:{lat:0,lng:0}}),[P,O]=h.useState(null),[S,$]=h.useState(!1),[C,x]=h.useState({}),[n,j]=h.useState(!1);h.useEffect(()=>{N(),l(),H()},[]);const H=async()=>{try{const t=await Ds("");b(t)}catch(t){console.error("Error fetching category suggestions:",t)}},N=async()=>{try{const t=await Y(!0);i(t)}catch(t){console.error("Error fetching shops:",t),p.error("Failed to fetch shops")}finally{k(!1)}},l=async()=>{try{const t=await ke();m(t)}catch(t){console.error("Error fetching categories:",t),p.error("Failed to fetch categories")}},f=async()=>{$(!0);try{const t=await os();D(u=>({...u,location:{lat:t.latitude,lng:t.longitude}})),p.success("Location updated successfully!")}catch(t){console.error("Error getting location:",t),p.error("Failed to get current location")}finally{$(!1)}},w=t=>{const u=ls(t);D(B=>({...B,shopName:t,hindi_shopName:u}))},L=()=>{const t={};return d.shopName.trim()||(t.shopName="Shop name is required"),d.ownerName.trim()||(t.ownerName="Owner name is required"),d.type.trim()||(t.type="Shop category is required"),d.shopType||(t.shopType="Shop type is required"),d.address.trim()||(t.address="Address is required"),d.phone.trim()||(t.phone="Phone number is required"),d.openingTime||(t.openingTime="Opening time is required"),d.closingTime||(t.closingTime="Closing time is required"),d.location.lat===0&&d.location.lng===0&&(t.location="Location coordinates are required"),x(t),Object.keys(t).length===0},q=async t=>{var u;if(t.preventDefault(),!L()){p.error("Please fill in all required fields");return}k(!0);try{const B={...d,shopName:d.shopName.trim(),hindi_shopName:((u=d.hindi_shopName)==null?void 0:u.trim())||"",ownerName:d.ownerName.trim(),type:d.type.trim(),shopType:d.shopType,address:d.address.trim(),phone:d.phone.trim(),mapLink:d.mapLink.trim(),openingTime:d.openingTime,closingTime:d.closingTime,isOpen:!!d.isOpen,isFeatured:!!d.isFeatured,isVerified:!!d.isVerified,isHidden:!!d.isHidden,location:{lat:Number(d.location.lat)||0,lng:Number(d.location.lng)||0},serviceDetails:d.shopType==="service"?d.serviceDetails.filter(V=>V.trim()):void 0,items:[]};z?(await Se(z.id,B,P||void 0),p.success("Shop updated successfully!")):(await ns(B,P||void 0),p.success("Shop added successfully!")),await N(),_()}catch(B){console.error("Error saving shop:",B),B instanceof Error&&B.message==="ADMIN_CLAIMS_REQUIRED"?j(!0):p.error("Failed to save shop")}finally{k(!1)}},o=t=>{I(t),D({shopName:t.shopName||"",hindi_shopName:t.hindi_shopName||"",ownerName:t.ownerName||"",type:t.type||"",shopType:t.shopType||"product",serviceDetails:t.serviceDetails||[],address:t.address||"",phone:t.phone||"",openingTime:t.openingTime||"",closingTime:t.closingTime||"",mapLink:t.mapLink||"",isOpen:t.isOpen!==void 0?t.isOpen:!0,isFeatured:t.isFeatured!==void 0?t.isFeatured:!1,isVerified:t.isVerified!==void 0?t.isVerified:!1,isHidden:t.isHidden!==void 0?t.isHidden:!1,location:t.location||{lat:0,lng:0}}),x({}),E(!0)},A=async t=>{if(confirm("Are you sure you want to delete this shop?"))try{await cs(t),p.success("Shop deleted successfully!"),await N()}catch(u){console.error("Error deleting shop:",u),u instanceof Error&&u.message==="ADMIN_CLAIMS_REQUIRED"?j(!0):p.error("Failed to delete shop")}},F=async t=>{try{await Se(t.id,{isHidden:!t.isHidden}),p.success(`Shop ${t.isHidden?"unhidden":"hidden"} successfully!`),await N()}catch(u){console.error("Error toggling shop visibility:",u),u instanceof Error&&u.message==="ADMIN_CLAIMS_REQUIRED"?j(!0):p.error("Failed to update shop visibility")}},_=()=>{D({shopName:"",hindi_shopName:"",ownerName:"",type:"",shopType:"product",serviceDetails:[],address:"",phone:"",openingTime:"",closingTime:"",mapLink:"",isOpen:!0,isFeatured:!1,isVerified:!1,isHidden:!1,location:{lat:0,lng:0}}),O(null),x({}),I(null),E(!1)};return y&&s.length===0?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Shop Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage registered shops and their information"})]}),e.jsxs("button",{onClick:()=>E(!0),className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-xl hover:bg-blue-700 transition-colors",children:[e.jsx(ie,{size:20}),e.jsx("span",{children:"Add Shop"})]})]}),g&&e.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:z?"Edit Shop":"Add New Shop"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"All fields marked with * are required"})]}),e.jsx("button",{onClick:_,className:"text-gray-400 hover:text-gray-600",children:e.jsx(ae,{size:24})})]}),e.jsxs("form",{onSubmit:q,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Shop Name *"}),e.jsx("input",{type:"text",value:d.shopName,onChange:t=>w(t.target.value),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${C.shopName?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,required:!0}),C.shopName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:C.shopName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hindi Shop Name (Auto-generated)"}),e.jsx("input",{type:"text",value:d.hindi_shopName,onChange:t=>D(u=>({...u,hindi_shopName:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50",placeholder:"Auto-generated from English name"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Automatically generated. Edit if needed."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Owner Name *"}),e.jsx("input",{type:"text",value:d.ownerName,onChange:t=>D(u=>({...u,ownerName:t.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${C.ownerName?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,required:!0}),C.ownerName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:C.ownerName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Shop Category *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",list:"categories",value:d.type,onChange:t=>D(u=>({...u,type:t.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${C.type?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,placeholder:"Select or type shop category",required:!0}),e.jsx("datalist",{id:"categories",children:c.map((t,u)=>e.jsx("option",{value:t,children:t},u))}),!C.type&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Select from existing categories or type a new one"}),C.type&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:C.type})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Shop Type *"}),e.jsxs("select",{value:d.shopType,onChange:t=>D(u=>({...u,shopType:t.target.value,serviceDetails:t.target.value==="service"?u.serviceDetails:[]})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"product",children:"ЁЯЫНя╕П Product - Sells physical items"}),e.jsx("option",{value:"menu",children:"ЁЯН╜я╕П Menu - Restaurant/Food service"}),e.jsx("option",{value:"service",children:"ЁЯФз Service - Provides services"})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[d.shopType==="product"&&"Shop sells physical products like groceries, electronics, etc.",d.shopType==="menu"&&"Restaurant or food service with menu items",d.shopType==="service"&&"Service provider like salon, repair, etc."]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone *"}),e.jsx("input",{type:"tel",value:d.phone,onChange:t=>D(u=>({...u,phone:t.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${C.phone?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,required:!0}),C.phone&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:C.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opening Time *"}),e.jsx("input",{type:"time",value:d.openingTime,onChange:t=>D(u=>({...u,openingTime:t.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${C.openingTime?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,required:!0}),C.openingTime&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:C.openingTime})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Closing Time *"}),e.jsx("input",{type:"time",value:d.closingTime,onChange:t=>D(u=>({...u,closingTime:t.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${C.closingTime?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,required:!0}),C.closingTime&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:C.closingTime})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Map Link"}),e.jsx("input",{type:"url",value:d.mapLink,onChange:t=>D(u=>({...u,mapLink:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),d.shopType==="service"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service Details / Key Points *"}),e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3 mb-3",children:[e.jsx("p",{className:"text-sm text-purple-800 font-medium mb-1",children:"ЁЯТб Pro Tip:"}),e.jsx("p",{className:"text-xs text-purple-700",children:"Add detailed service descriptions. These will be displayed as an attractive poster when customers visit your shop page."})]}),e.jsxs("div",{className:"space-y-3",children:[d.serviceDetails.map((t,u)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:t,onChange:B=>{const V=[...d.serviceDetails];V[u]=B.target.value,D(M=>({...M,serviceDetails:V}))},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Service detail ${u+1} (e.g., "Professional hair cutting and styling with modern techniques", "Mobile screen repair with 6-month warranty")`}),e.jsx("button",{type:"button",onClick:()=>{const B=d.serviceDetails.filter((V,M)=>M!==u);D(V=>({...V,serviceDetails:B}))},className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(ae,{size:16})})]},u)),e.jsxs("button",{type:"button",onClick:()=>{D(t=>({...t,serviceDetails:[...t.serviceDetails,""]}))},className:"flex items-center space-x-2 text-blue-600 hover:text-blue-700 text-sm font-medium",children:[e.jsx(ie,{size:16}),e.jsx("span",{children:"Add Service Detail"})]})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Add detailed descriptions of your services. These will be displayed as an attractive service poster to customers."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address *"}),e.jsx("textarea",{value:d.address,onChange:t=>D(u=>({...u,address:t.target.value})),rows:3,className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${C.address?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,required:!0}),C.address&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:C.address})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Latitude *"}),e.jsx("input",{type:"number",step:"any",value:d.location.lat,onChange:t=>D(u=>({...u,location:{...u.location,lat:parseFloat(t.target.value)||0}})),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${C.location?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Longitude *"}),e.jsx("input",{type:"number",step:"any",value:d.location.lng,onChange:t=>D(u=>({...u,location:{...u.location,lng:parseFloat(t.target.value)||0}})),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 ${C.location?"border-red-300 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,required:!0})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{type:"button",onClick:f,disabled:S,className:"w-full flex items-center justify-center space-x-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:S?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{size:16}),e.jsx("span",{children:"ЁЯУН Use My Location"})]})})})]}),C.location&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:C.location}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Shop Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:t=>{var u;return O(((u=t.target.files)==null?void 0:u[0])||null)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:d.isOpen,onChange:t=>D(u=>({...u,isOpen:t.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Shop is Open"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:d.isFeatured,onChange:t=>D(u=>({...u,isFeatured:t.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Featured Shop"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:d.isVerified,onChange:t=>D(u=>({...u,isVerified:t.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Verified Shop"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:d.isHidden,onChange:t=>D(u=>({...u,isHidden:t.target.checked})),className:"rounded border-gray-300 text-red-600 focus:ring-red-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Hide Shop"})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{type:"submit",disabled:y,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:y?"Saving...":z?"Update Shop":"Add Shop"}),e.jsx("button",{type:"button",onClick:_,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Registered Shops (",s.length,")"]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:s.map(t=>e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:t.shopName}),t.hindi_shopName&&e.jsxs("span",{className:"text-sm text-gray-600",children:["(",t.hindi_shopName,")"]}),e.jsxs("div",{className:"flex space-x-2",children:[t.isFeatured&&e.jsx("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs",children:"Featured"}),t.isVerified&&e.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs",children:"Verified"}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.isOpen?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.isOpen?"Open":"Closed"}),t.isHidden&&e.jsx("span",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded-full text-xs",children:"Hidden"})]})]}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Owner:"})," ",t.ownerName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Category:"})," ",e.jsx("span",{className:"capitalize",children:t.type||"Not specified"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("strong",{children:"Shop Type:"}),e.jsxs("span",{className:`inline-flex items-center space-x-1 px-2 py-1 rounded-full text-xs font-medium ${t.shopType==="product"?"bg-blue-100 text-blue-800":t.shopType==="menu"?"bg-orange-100 text-orange-800":"bg-purple-100 text-purple-800"}`,children:[e.jsx("span",{children:t.shopType==="product"?"ЁЯЫНя╕П":t.shopType==="menu"?"ЁЯН╜я╕П":"ЁЯФз"}),e.jsx("span",{className:"capitalize",children:t.shopType||"Product"})]})]}),t.shopType==="service"&&t.serviceDetails&&t.serviceDetails.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Service Details:"}),e.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[t.serviceDetails.slice(0,3).map((u,B)=>e.jsx("li",{className:"text-xs text-gray-600",children:u},B)),t.serviceDetails.length>3&&e.jsxs("li",{className:"text-xs text-gray-500",children:["+",t.serviceDetails.length-3," more details"]})]})]}),t.openingTime&&t.closingTime&&e.jsxs("p",{children:[e.jsx("strong",{children:"Hours:"})," ",qe(t.openingTime)," - ",qe(t.closingTime)]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(is,{size:14}),e.jsx("span",{children:t.phone})]}),e.jsxs("div",{className:"flex items-start space-x-1",children:[e.jsx(Ce,{size:14,className:"mt-0.5"}),e.jsx("span",{className:"line-clamp-2",children:t.address})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Location:"})," ",t.location.lat.toFixed(6),", ",t.location.lng.toFixed(6)]}),t.ratings&&t.ratings.length>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ye,{size:14,className:"text-yellow-500"}),e.jsxs("span",{children:[(t.ratings.reduce((u,B)=>u+B,0)/t.ratings.length).toFixed(1),"(",t.ratings.length," reviews)"]})]})]})]}),e.jsxs("div",{className:"flex space-x-2 ml-4",children:[e.jsx("button",{onClick:()=>F(t),className:`p-2 rounded-lg transition-colors ${t.isHidden?"text-green-600 hover:bg-green-50":"text-orange-600 hover:bg-orange-50"}`,title:t.isHidden?"Unhide shop":"Hide shop",children:t.isHidden?e.jsx(fe,{size:16}):e.jsx(Ee,{size:16})}),e.jsx("button",{onClick:()=>o(t),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:e.jsx(Ne,{size:16})}),e.jsx("button",{onClick:()=>A(t.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(je,{size:16})})]})]})},t.id))}),s.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No shops registered yet."})})]}),e.jsx(Es,{isOpen:n,onClose:()=>j(!1),onSuccess:()=>{j(!1),window.location.reload()}})]})},Ls=({shops:s,selectedType:i,onShopSelect:a,searchQuery:m,onSearchChange:c})=>{const[b,y]=h.useState("grid"),[k,g]=h.useState([]);h.useEffect(()=>{let I=s;if(i&&(I=I.filter(d=>d.shopType===i)),m){const d=m.toLowerCase();I=I.filter(D=>D.shopName.toLowerCase().includes(d)||D.ownerName.toLowerCase().includes(d)||D.type.toLowerCase().includes(d)||D.address.toLowerCase().includes(d))}g(I)},[s,i,m]);const E=I=>{switch(I){case"product":return"ЁЯЫНя╕П";case"menu":return"ЁЯН╜я╕П";case"service":return"ЁЯФз";default:return"ЁЯПк"}},z=I=>{switch(I){case"product":return"from-green-500 to-emerald-600";case"menu":return"from-blue-500 to-indigo-600";case"service":return"from-purple-500 to-violet-600";default:return"from-gray-500 to-gray-600"}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(re,{className:"text-blue-600",size:20}),e.jsxs("h3",{className:"font-semibold text-gray-900",children:["Select Shop ",i&&`(${i} shops)`]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[k.length," of ",s.length]}),e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>y("grid"),className:`p-1 rounded transition-colors ${b==="grid"?"bg-white shadow-sm":"text-gray-600"}`,children:e.jsx(ds,{size:14})}),e.jsx("button",{onClick:()=>y("list"),className:`p-1 rounded transition-colors ${b==="list"?"bg-white shadow-sm":"text-gray-600"}`,children:e.jsx(ms,{size:14})})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search shops...",value:m,onChange:I=>c(I.target.value),className:"w-full pl-9 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),e.jsx("div",{className:`${b==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4":"space-y-3"} max-h-96 overflow-y-auto`,children:k.map((I,d)=>e.jsx(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:d*.05},onClick:()=>a(I),className:`bg-white rounded-xl border-2 border-gray-200 hover:border-blue-300 hover:shadow-md transition-all cursor-pointer group ${b==="list"?"flex items-center p-4":"p-4"}`,children:e.jsxs("div",{className:b==="list"?"flex items-center space-x-4 flex-1":"space-y-3",children:[e.jsx("div",{className:`${b==="list"?"w-12 h-12":"w-16 h-16 mx-auto"} bg-gradient-to-br ${z(I.shopType)} rounded-xl flex items-center justify-center text-white text-xl shadow-lg`,children:E(I.shopType)}),e.jsxs("div",{className:b==="list"?"flex-1":"text-center",children:[e.jsx("h4",{className:"font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:I.shopName}),e.jsx("p",{className:"text-sm text-gray-600",children:I.ownerName}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${I.shopType==="product"?"bg-green-100 text-green-800":I.shopType==="menu"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:I.shopType}),e.jsx("span",{className:"text-xs text-gray-500 capitalize",children:I.type})]})]})]})},I.id))}),k.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(re,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"No shops found"}),e.jsx("p",{className:"text-sm text-gray-600",children:i?`No ${i} shops found${m?` matching "${m}"`:""}`:m?`No shops found matching "${m}"`:"No shops available"})]})]})},te={a:"рдЕ",aa:"рдЖ",i:"рдЗ",ii:"рдИ",u:"рдЙ",uu:"рдК",e:"рдП",ai:"рдР",o:"рдУ",au:"рдФ",ka:"рдХ",kha:"рдЦ",ga:"рдЧ",gha:"рдШ",nga:"рдЩ",cha:"рдЪ",chha:"рдЫ",ja:"рдЬ",jha:"рдЭ",nya:"рдЮ",ta:"рдЯ",tha:"рда",da:"рдб",dha:"рдв",na:"рдг",ta:"рдд",tha:"рде",da:"рдж",dha:"рдз",na:"рди",pa:"рдк",pha:"рдл",ba:"рдм",bha:"рдн",ma:"рдо",ya:"рдп",ra:"рд░",la:"рд▓",va:"рд╡",sha:"рд╢",shha:"рд╖",sa:"рд╕",ha:"рд╣",rice:"рдЪрд╛рд╡рд▓",dal:"рджрд╛рд▓",oil:"рддреЗрд▓",sugar:"рдЪреАрдиреА",salt:"рдирдордХ",flour:"рдЖрдЯрд╛",milk:"рджреВрдз",tea:"рдЪрд╛рдп",coffee:"рдХреЙрдлреА",bread:"рд░реЛрдЯреА",water:"рдкрд╛рдиреА",vegetable:"рд╕рдмреНрдЬреА",fruit:"рдлрд▓",meat:"рдорд╛рдВрд╕",chicken:"рдореБрд░реНрдЧреА",fish:"рдордЫрд▓реА",egg:"рдЕрдВрдбрд╛",onion:"рдкреНрдпрд╛рдЬ",potato:"рдЖрд▓реВ",tomato:"рдЯрдорд╛рдЯрд░",garlic:"рд▓рд╣рд╕реБрди",ginger:"рдЕрджрд░рдХ",chili:"рдорд┐рд░реНрдЪ"};function Ye(s){if(!s)return"";const i=s.toLowerCase().trim();return te[i]?te[i]:i.split(/[\s\-_]+/).map(c=>te[c]?te[c]:Fs(c)).join(" ")}function Fs(s){if(!s)return"";let i="",a=0;for(;a<s.length;){let m=!1;for(let c=3;c>=1;c--){const b=s.substr(a,c);if(te[b]){i+=te[b],a+=c,m=!0;break}}if(!m){const c=s[a];switch(c){case"k":i+="рдХ";break;case"g":i+="рдЧ";break;case"c":i+="рдЪ";break;case"j":i+="рдЬ";break;case"t":i+="рдд";break;case"d":i+="рдж";break;case"n":i+="рди";break;case"p":i+="рдк";break;case"b":i+="рдм";break;case"m":i+="рдо";break;case"y":i+="рдп";break;case"r":i+="рд░";break;case"l":i+="рд▓";break;case"v":case"w":i+="рд╡";break;case"s":i+="рд╕";break;case"h":i+="рд╣";break;default:i+=c;break}a++}}return i}const _s=({shopId:s,shopName:i,itemType:a,onSuccess:m,onCancel:c})=>{const[b,y]=h.useState(""),[k,g]=h.useState([]),[E,z]=h.useState(!1),[I,d]=h.useState(!1),[D,P]=h.useState(""),O=l=>{var L;const f=(L=l.target.files)==null?void 0:L[0];if(!f)return;if(!f.name.endsWith(".csv")){P("Please upload a CSV file");return}const w=new FileReader;w.onload=q=>{var A;const o=(A=q.target)==null?void 0:A.result;y(o),P("")},w.readAsText(f)},S=l=>{const f=[];let w="",L=!1;for(let q=0;q<l.length;q++){const o=l[q];o==='"'?L=!L:o===","&&!L?(f.push(w.trim()),w=""):w+=o}return f.push(w.trim()),f},$=l=>{const f=[];return(!l.name||!l.name.trim())&&f.push("Item name is required"),l.name&&l.name.length>100&&f.push("Item name must be less than 100 characters"),l.category&&l.category.length>50&&f.push("Category must be less than 50 characters"),a==="product"&&(!l.inStock||l.inStock.trim()==="")&&f.push("Stock quantity is required for products"),f},C=()=>{if(!b.trim()){P("Please upload a CSV file or paste CSV data");return}try{d(!0);const l=b.trim().split(`
`);if(l.length<2)throw new Error("CSV must contain at least a header row and one data row");const f=S(l[0]).map(o=>o.trim().toLowerCase()),L=["name"].filter(o=>!f.includes(o));if(L.length>0)throw new Error(`Missing required headers: ${L.join(", ")}`);const q=[];for(let o=1;o<l.length;o++){const A=l[o].trim();if(!A)continue;const F=S(A);if(F.length<f.length)for(;F.length<f.length;)F.push("");else if(F.length>f.length)throw new Error(`Row ${o+1}: Too many columns (expected ${f.length}, got ${F.length})`);const _={rowIndex:o+1};f.forEach((B,V)=>{const M=F[V]||"";switch(B){case"name":_.name=M;break;case"hindi_name":_.hindi_name=M||void 0;break;case"category":_.category=M||void 0;break;case"type":_.type=M||void 0;break;case"variety":_.variety=M||void 0;break;case"brand_name":_.brand_name=M||void 0;break;case"price":_.price=M||void 0;break;case"instock":case"in_stock":_.inStock=M||void 0;break;case"unit":_.unit=M||void 0;break;case"availability":case"isavailable":_.availability=M?M.toLowerCase()==="true"||M==="1":!0;break}});const t=!!(_.hindi_name&&_.hindi_name.trim());!t&&_.name&&(_.hindi_name=Ye(_.name));const u=$(_);q.push({..._,errors:u,hasHindiName:t})}g(q),z(!0),P("")}catch(l){P(l.message||"Failed to parse CSV data")}finally{d(!1)}},x=async()=>{const l=k.filter(f=>f.errors.length===0);if(l.length===0){P("No valid items to upload. Please fix the errors.");return}d(!0);try{const f=l.map(({rowIndex:w,errors:L,hasHindiName:q,...o})=>({...o,type:a,shopId:s}));await m(f)}catch(f){P(f.message||"Failed to upload items")}finally{d(!1)}},n=()=>{let l="";a==="product"?l=`name,hindi_name,category,type,variety,brand_name,price,availability,inStock
Sugar,,Grocery,product,White,Tata,45,true,true
Rice,,Grocery,product,Basmati,India Gate,120,true,false
Wheat Flour,,Grocery,product,Whole Wheat,Aashirvaad,55,true,true`:a==="menu"?l=`name,hindi_name,category,type,brand_name,price,availability
Butter Chicken,,Main Course,menu,,350,true
Masala Dosa,,South Indian,menu,,120,true
Gulab Jamun,,Desserts,menu,,80,true`:a==="service"&&(l=`name,hindi_name,category,type,brand_name,price,availability
Hair Cut,,Beauty,service,,200,true
Mobile Repair,,Electronics,service,,500,true
Home Cleaning,,Cleaning,service,,800,true`);const f=new Blob([l],{type:"text/csv"}),w=window.URL.createObjectURL(f),L=document.createElement("a");L.href=w,L.download=`${a}_items_template.csv`,L.click(),window.URL.revokeObjectURL(w)},j=k.filter(l=>l.errors.length===0).length,H=k.filter(l=>l.errors.length>0).length,N=k.filter(l=>!l.hasHindiName&&l.hindi_name).length;return e.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs(T.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-blue-500 to-purple-500 text-white",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(he,{size:24}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold",children:["Bulk Upload ",a.charAt(0).toUpperCase()+a.slice(1)," Items"]}),e.jsxs("p",{className:"text-blue-100 text-sm",children:["Upload to ",i," with automatic Hindi translation"]})]})]}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:e.jsx(ae,{size:20})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:[E?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 text-center",children:[e.jsx(ue,{className:"text-green-600 mx-auto mb-2",size:24}),e.jsx("div",{className:"text-2xl font-bold text-green-900",children:j}),e.jsx("div",{className:"text-green-700 text-sm",children:"Valid Items"})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 text-center",children:[e.jsx(Me,{className:"text-blue-600 mx-auto mb-2",size:24}),e.jsx("div",{className:"text-2xl font-bold text-blue-900",children:N}),e.jsx("div",{className:"text-blue-700 text-sm",children:"Auto-translated"})]}),H>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 text-center",children:[e.jsx(de,{className:"text-red-600 mx-auto mb-2",size:24}),e.jsx("div",{className:"text-2xl font-bold text-red-900",children:H}),e.jsx("div",{className:"text-red-700 text-sm",children:"Items with Errors"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 max-h-96 overflow-y-auto",children:[e.jsxs("h3",{className:"font-medium text-gray-900 mb-4",children:["Preview (",k.length," items)"]}),e.jsx("div",{className:"space-y-3",children:k.map((l,f)=>e.jsxs("div",{className:`p-4 rounded-lg border ${l.errors.length>0?"bg-red-50 border-red-200":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:l.name}),l.hindi_name&&e.jsxs("div",{className:"flex items-center space-x-1 text-blue-600",children:[e.jsx(Me,{size:12}),e.jsx("span",{className:"text-sm",children:l.hindi_name}),!l.hasHindiName&&e.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-1 rounded",children:"auto"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-sm text-gray-600",children:[l.category&&e.jsx("span",{className:"bg-gray-100 px-2 py-1 rounded",children:l.category}),l.brand_name&&e.jsx("span",{className:"bg-purple-100 text-purple-800 px-2 py-1 rounded",children:l.brand_name}),l.price&&e.jsxs("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded",children:["тВ╣",l.price]}),l.inStock&&e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded",children:["Stock: ",l.inStock]}),l.unit&&e.jsx("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded",children:l.unit})]}),(l.type||l.variety)&&e.jsxs("p",{className:"text-gray-600 text-sm mt-2",children:[l.type&&`Type: ${l.type}`,l.type&&l.variety&&" тАв ",l.variety&&`Variety: ${l.variety}`]})]}),e.jsx("div",{className:"ml-4",children:l.errors.length>0?e.jsx("div",{className:"text-red-600",children:e.jsx(de,{size:16})}):e.jsx("div",{className:"text-green-600",children:e.jsx(ue,{size:16})})})]}),l.errors.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-red-100 rounded-lg",children:[e.jsxs("h5",{className:"text-red-800 font-medium text-sm mb-1",children:["Row ",l.rowIndex," Errors:"]}),e.jsx("ul",{className:"text-red-700 text-xs space-y-1",children:l.errors.map((w,L)=>e.jsxs("li",{children:["тАв ",w]},L))})]})]},f))})]}),D&&e.jsxs(T.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-4 bg-red-50 border border-red-200 rounded-xl flex items-center space-x-2",children:[e.jsx(de,{size:16,className:"text-red-500 flex-shrink-0"}),e.jsx("span",{className:"text-red-700",children:D})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>{z(!1),g([]),y("")},className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors font-medium",children:"Back to Upload"}),e.jsx("button",{onClick:x,disabled:I||j===0,className:"flex-1 flex items-center justify-center space-x-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:I?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):e.jsxs(e.Fragment,{children:[e.jsx(he,{size:18}),e.jsxs("span",{children:["Upload ",j," Items"]})]})})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(He,{className:"text-blue-600",size:20}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-blue-900",children:"Download Template"}),e.jsxs("p",{className:"text-blue-700 text-sm",children:["Use our template for ",a," items"]})]})]}),e.jsxs("button",{onClick:n,className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(ks,{size:16}),e.jsx("span",{children:"Download"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload CSV File"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-blue-400 transition-colors",children:[e.jsx(he,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("span",{className:"text-blue-600 font-medium hover:text-blue-700",children:"Click to upload CSV file"}),e.jsx("input",{type:"file",accept:".csv",onChange:O,className:"hidden"})]}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Or drag and drop your CSV file here"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Or Paste CSV Data"}),e.jsx("textarea",{value:b,onChange:l=>y(l.target.value),placeholder:"Paste your CSV data here...",rows:8,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm"})]}),D&&e.jsxs(T.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-4 bg-red-50 border border-red-200 rounded-xl flex items-center space-x-2",children:[e.jsx(de,{size:16,className:"text-red-500 flex-shrink-0"}),e.jsx("span",{className:"text-red-700",children:D})]}),e.jsx("button",{onClick:C,disabled:!b.trim()||I,className:"w-full flex items-center justify-center space-x-2 bg-blue-600 text-white py-3 px-6 rounded-xl hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:I?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):e.jsxs(e.Fragment,{children:[e.jsx(He,{size:18}),e.jsx("span",{children:"Parse & Preview"})]})})]}),!E&&e.jsxs("div",{className:"mt-6 bg-gray-50 rounded-xl p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"CSV Format Guide"}),e.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Required columns:"})," name"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Optional columns:"})," hindi_name, category, type, variety, brand_name, price, unit, availability",a==="product"&&", inStock (required for products)",a==="menu"&&", description",a==="service"&&", description (recommended)"]}),e.jsx("p",{children:e.jsx("strong",{children:"Notes:"})}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-xs text-gray-600 ml-4",children:[e.jsx("li",{children:"If hindi_name is empty, it will be auto-generated from the English name"}),e.jsxs("li",{children:["Items will be added to ",i]}),e.jsx("li",{children:"availability should be 'true' or 'false' (defaults to true)"}),e.jsx("li",{children:"Use commas to separate columns, quote text containing commas"}),a==="product"&&e.jsx("li",{children:"inStock is required for product items"})]})]})]})]})]})})},$s=()=>{const[s,i]=h.useState([]),[a,m]=h.useState(null),[c,b]=h.useState(""),[y,k]=h.useState([]),[g,E]=h.useState([]),[z,I]=h.useState(!0),[d,D]=h.useState(!1),[P,O]=h.useState(""),[S,$]=h.useState(""),[C,x]=h.useState("shops"),[n,j]=h.useState(!1),[H,N]=h.useState(!1),[l,f]=h.useState(null),[w,L]=h.useState({shopId:"",type:"product",name:"",description:"",price:"",category:"",availability:!0});h.useEffect(()=>{q()},[]),h.useEffect(()=>{o()},[s,c,P]),h.useEffect(()=>{a&&A()},[a,c]);const q=async()=>{try{I(!0);const r=await Y(!0);i(r)}catch(r){console.error("Error loading shops:",r),p.error("Failed to load shops")}finally{I(!1)}},o=()=>{let r=s;if(c&&(c==="product"?r=s:c==="menu"?r=r.filter(v=>{var R;return v.shopType==="menu"||["restaurant","cafe","hotel"].includes(((R=v.type)==null?void 0:R.toLowerCase())||"")}):c==="service"&&(r=r.filter(v=>{var R;return v.shopType==="service"||((R=v.serviceDetails)==null?void 0:R.length)>0}))),P){const v=P.toLowerCase();r=r.filter(R=>R.shopName.toLowerCase().includes(v)||R.ownerName.toLowerCase().includes(v)||R.type.toLowerCase().includes(v)||R.address.toLowerCase().includes(v))}E(r)},A=async()=>{if(a)try{D(!0);const r=await ze(a.id,c||void 0,!0);k(r)}catch(r){console.error("Error loading items:",r),p.error("Failed to load items")}finally{D(!1)}},F=r=>{var v,R;m(r),x("items"),c===""&&(r.shopType==="menu"||["restaurant","cafe","hotel"].includes(((v=r.type)==null?void 0:v.toLowerCase())||"")?b("menu"):r.shopType==="service"||((R=r.serviceDetails)==null?void 0:R.length)>0?b("service"):b("product"))},_=r=>{b(r),m(null),x("shops")},t=()=>{if(!a){p.error("Please select a shop first");return}L({shopId:a.id,type:c||"product",name:"",hindi_name:"",description:"",price:"",category:"",availability:!0,brand_name:"",variety:"",inStock:c==="product"?!0:void 0,unit:c==="menu"||c==="service"?"":void 0}),f(null),j(!0)},u=r=>{var v;L({shopId:r.shopId,type:r.type,name:r.name||"",description:r.description||"",price:((v=r.price)==null?void 0:v.toString())||"",category:r.category||"",availability:r.availability!==!1,inStock:r.type==="product"?typeof r.inStock=="boolean"?r.inStock:!!r.inStock:void 0,hindi_name:r.hindi_name||"",brand_name:r.brand_name||"",variety:r.variety||"",unit:r.type==="menu"||r.type==="service"?r.unit||"":void 0}),f(r),j(!0)},B=async r=>{if(confirm(`Are you sure you want to delete "${r.name}"?`))try{await hs(r.shopId,r.id),p.success("Item deleted successfully"),A()}catch(v){console.error("Error deleting item:",v),p.error("Failed to delete item")}},V=async r=>{if(!a){p.error("Please select a shop first");return}try{await ps(a.id,r),p.success(`Successfully uploaded ${r.length} items!`),N(!1),A()}catch(v){console.error("Error bulk uploading items:",v),p.error("Failed to upload items")}},M=r=>{const v=Ye(r);L(R=>({...R,name:r,hindi_name:v}))},Xe=async r=>{r.preventDefault();try{let v={...w};w.type==="product"&&(v.inStock=w.inStock===!0||w.inStock===1||w.inStock==="1"?1:0),l?(await us(l.shopId,l.id,v),p.success("Item updated successfully")):(await gs(v),p.success("Item added successfully")),j(!1),f(null),A()}catch(v){console.error("Error saving item:",v),p.error("Failed to save item")}},ce=y.filter(r=>{var R,X,_e,$e,Pe;if(!S)return!0;const v=S.toLowerCase();return((R=r.name)==null?void 0:R.toLowerCase().includes(v))||((X=r.hindi_name)==null?void 0:X.toLowerCase().includes(v))||((_e=r.description)==null?void 0:_e.toLowerCase().includes(v))||(($e=r.category)==null?void 0:$e.toLowerCase().includes(v))||((Pe=r.brand_name)==null?void 0:Pe.toLowerCase().includes(v))}),Fe=r=>{switch(r){case"product":return e.jsx(J,{className:"w-5 h-5 text-green-600"});case"menu":return e.jsx(ye,{className:"w-5 h-5 text-blue-600"});case"service":return e.jsx(De,{className:"w-5 h-5 text-purple-600"})}},Ze=r=>{switch(r){case"product":return"from-green-500 to-emerald-600";case"menu":return"from-blue-500 to-indigo-600";case"service":return"from-purple-500 to-violet-600"}},es=r=>{switch(r){case"product":return"ЁЯЫНя╕П";case"menu":return"ЁЯН╜я╕П";case"service":return"ЁЯФз";default:return"ЁЯПк"}};return z?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(J,{className:"text-blue-500",size:32}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Enhanced Item Manager"}),e.jsx("p",{className:"text-gray-600",children:"Smart shop-connected item management"})]})]}),a&&C==="items"&&e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:()=>N(!0),className:"flex items-center space-x-2 bg-green-600 text-white px-4 py-2 rounded-xl hover:bg-green-700 transition-colors",children:[e.jsx(he,{size:20}),e.jsx("span",{children:"Bulk Upload"})]}),e.jsxs("button",{onClick:t,className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-xl hover:bg-blue-700 transition-colors",children:[e.jsx(ie,{size:20}),e.jsx("span",{children:"Add Item"})]})]})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur-md rounded-2xl p-6 border border-white/20 shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Item Type"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["product","menu","service"].map(r=>e.jsx(T.button,{onClick:()=>_(r),whileHover:{scale:1.02},whileTap:{scale:.98},className:`p-6 rounded-xl border-2 transition-all ${c===r?`border-blue-500 bg-gradient-to-r ${Ze(r)} text-white shadow-lg`:"border-gray-200 bg-white hover:border-gray-300 hover:shadow-md"}`,children:e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${c===r?"bg-white/20":"bg-gray-100"}`,children:Fe(r)}),e.jsxs("div",{className:"text-center",children:[e.jsxs("h4",{className:"font-semibold capitalize",children:[r,"s"]}),e.jsxs("p",{className:`text-sm ${c===r?"text-white/80":"text-gray-600"}`,children:[r==="product"&&"Physical items & inventory",r==="menu"&&"Restaurant menu items",r==="service"&&"Services & consultations"]}),e.jsxs("p",{className:`text-xs mt-1 ${c===r?"text-white/60":"text-gray-500"}`,children:[g.filter(v=>{var R,X;return r==="product"?!0:r==="menu"?v.shopType==="menu"||["restaurant","cafe","hotel"].includes(((R=v.type)==null?void 0:R.toLowerCase())||""):r==="service"?v.shopType==="service"||((X=v.serviceDetails)==null?void 0:X.length)>0:!1}).length," shops available"]})]})]})},r))})]}),C==="items"&&a&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsxs("button",{onClick:()=>{x("shops"),m(null)},className:"flex items-center space-x-1 hover:text-blue-600 transition-colors",children:[e.jsx(xs,{size:16}),e.jsx("span",{children:"Back to Shops"})]}),e.jsx("span",{children:"тАв"}),e.jsx("span",{className:"font-medium text-gray-900",children:a.shopName}),c&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"тАв"}),e.jsxs("span",{className:"capitalize",children:[c," Items"]})]})]}),C==="shops"&&e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-white/90 backdrop-blur-md rounded-2xl p-6 border border-white/20 shadow-lg",children:e.jsx(Ls,{shops:g,selectedType:c,onShopSelect:F,searchQuery:P,onSearchChange:O})})}),C==="items"&&a&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white/90 backdrop-blur-md rounded-2xl p-6 border border-white/20 shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center text-white text-2xl shadow-lg",children:es(a.shopType)}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:a.shopName}),e.jsxs("p",{className:"text-gray-600",children:[a.ownerName," тАв ",a.type]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a.shopType==="product"?"bg-green-100 text-green-800":a.shopType==="menu"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:[a.shopType," Shop"]}),a.isVerified&&e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs",children:"Verified"})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Items"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:ce.length})]})]})}),e.jsxs("div",{className:"bg-white/90 backdrop-blur-md rounded-2xl border border-white/20 shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:c?`${c.charAt(0).toUpperCase()+c.slice(1)} Items`:"All Items"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("span",{className:"text-sm text-gray-600",children:[ce.length," of ",y.length," items"]})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search items...",value:S,onChange:r=>$(r.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),d?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):ce.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(J,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No items found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:S?`No items match "${S}"`:`This shop doesn't have any ${c||""} items yet.`}),S?e.jsx("button",{onClick:()=>$(""),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors mr-3",children:"Clear Search"}):null,e.jsx("button",{onClick:t,className:"bg-blue-600 text-white px-6 py-3 rounded-xl hover:bg-blue-700 transition-colors",children:"Add First Item"})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:ce.map((r,v)=>e.jsx(T.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:v*.03},className:"p-6 hover:bg-gray-50/80 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${r.type==="product"?"bg-green-100":r.type==="menu"?"bg-blue-100":"bg-purple-100"}`,children:Fe(r.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:r.name||(r.type==="service"&&r.description?r.description.substring(0,50)+(r.description.length>50?"...":""):"Service Item")}),r.hindi_name&&e.jsx("p",{className:"text-sm text-gray-600",children:r.hindi_name}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[r.category&&e.jsx("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded-full text-xs",children:r.category}),r.brand_name&&e.jsx("span",{className:"bg-blue-100 text-blue-700 px-2 py-1 rounded-full text-xs",children:r.brand_name}),r.price&&e.jsxs("span",{className:"bg-green-100 text-green-700 px-2 py-1 rounded-full text-xs font-medium",children:["тВ╣",r.price]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${r.availability!==!1?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:r.availability!==!1?"Available":"Unavailable"})]}),r.type==="product"&&r.inStock!==void 0&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Stock: ",r.inStock," ",r.unit||"units"]}),r.type==="service"&&r.highlights&&r.highlights.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs text-purple-600 font-medium mb-1",children:"Service Highlights:"}),e.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:r.highlights.slice(0,2).map((R,X)=>e.jsxs("li",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"w-1 h-1 bg-purple-500 rounded-full"}),e.jsx("span",{children:R})]},X))})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>u(r),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit item",children:e.jsx(Ne,{size:16})}),e.jsx("button",{onClick:()=>B(r),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete item",children:e.jsx(je,{size:16})})]})]})},r.id))})]})]}),e.jsx(oe,{children:n&&e.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsx(T.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-700",children:l?"Edit Item":"Add New Item"}),e.jsx("button",{onClick:()=>j(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(ae,{size:20})})]}),e.jsxs("form",{onSubmit:Xe,className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-50 rounded-xl p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center text-white",children:e.jsx(re,{size:18})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:a==null?void 0:a.shopName}),e.jsxs("p",{className:"text-sm text-blue-700 capitalize",children:[w.type," Item"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Item Name ",w.type!=="service"?"*":"(Optional)"]}),e.jsx("input",{type:"text",value:w.name,onChange:r=>M(r.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:w.type==="service"?"Optional - can use description instead":"Enter item name",required:w.type!=="service"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hindi Name (Auto-generated)"}),e.jsx("input",{type:"text",value:w.hindi_name||"",onChange:r=>L(v=>({...v,hindi_name:r.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50",placeholder:"Auto-generated from English name"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Automatically generated. Edit if needed."})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Description ",w.type==="service"?"(Required if no name)":""]}),e.jsx("textarea",{value:w.description,onChange:r=>L(v=>({...v,description:r.target.value})),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:w.type==="service"?"Describe the service offered (e.g., Professional hair cutting and styling)":"Optional description"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsx("input",{type:"text",value:w.category,onChange:r=>L(v=>({...v,category:r.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter category"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price"}),e.jsx("input",{type:"number",step:"0.01",value:w.price,onChange:r=>L(v=>({...v,price:r.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter price"})]})]}),w.type==="product"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"In Stock *"}),e.jsxs("select",{value:w.inStock===!0||w.inStock===1||w.inStock==="1"?"true":"false",onChange:r=>L(v=>({...v,inStock:r.target.value==="true"})),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500",required:!0,children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Brand"}),e.jsx("input",{type:"text",value:w.brand_name||"",onChange:r=>L(v=>({...v,brand_name:r.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),w.type==="menu"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Unit"}),e.jsx("input",{type:"text",value:w.unit||"",onChange:r=>L(v=>({...v,unit:r.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"plate, bowl, glass, etc."})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:"availability",checked:w.availability,onChange:r=>L(v=>({...v,availability:r.target.checked})),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"availability",className:"text-sm font-medium text-gray-700",children:"Item is available"})]}),e.jsxs("div",{className:"flex space-x-4 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>j(!1),className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-6 py-3 rounded-xl hover:bg-blue-700 transition-colors font-medium",children:l?"Update Item":"Add Item"})]})]})]})})})}),e.jsx(oe,{children:H&&a&&e.jsx(_s,{shopId:a.id,shopName:a.shopName,itemType:c||"product",onSuccess:V,onCancel:()=>N(!1)})})]})},Ps=()=>{const[s,i]=h.useState({totalBookings:0,weeklyBookings:0,mostBookedItem:"N/A",mostActiveShop:"N/A",averageDistance:0,topItems:[],topShops:[],recentBookings:[]}),[a,m]=h.useState(!0),[c,b]=h.useState("week");h.useEffect(()=>{y()},[c]);const y=async()=>{try{m(!0);const[g,E,z]=await Promise.all([bs(),ys(),Y()]),I=new Date,d=new Date(I.getTime()-7*24*60*60*1e3),D=new Date(I.getTime()-30*24*60*60*1e3),P=c==="week"?d:D,O=g.filter(N=>N.timestamp&&N.timestamp.toDate()>=P),S={};E.forEach(N=>{if(S[N.itemName])S[N.itemName].count+=N.count;else{const l=z.find(f=>f.id===N.shopId);S[N.itemName]={count:N.count,shopName:(l==null?void 0:l.shopName)||"Unknown Shop"}}});const $=Object.entries(S).map(([N,l])=>({name:N,count:l.count,shopName:l.shopName})).sort((N,l)=>l.count-N.count).slice(0,5),C={};O.forEach(N=>{C[N.shopId]=(C[N.shopId]||0)+1});const x=Object.entries(C).map(([N,l])=>{const f=z.find(w=>w.id===N);return{name:(f==null?void 0:f.shopName)||"Unknown Shop",bookings:l,distance:"1.2km"}}).sort((N,l)=>l.bookings-N.bookings).slice(0,5),n=x.length>0?x[0].name:"N/A",j=$.length>0?$[0].name:"N/A",H=g.sort((N,l)=>{var f,w;return(((f=l.timestamp)==null?void 0:f.toMillis())||0)-(((w=N.timestamp)==null?void 0:w.toMillis())||0)}).slice(0,10);i({totalBookings:g.length,weeklyBookings:O.length,mostBookedItem:j,mostActiveShop:n,averageDistance:1.5,topItems:$,topShops:x,recentBookings:H})}catch(g){console.error("Error fetching analytics:",g)}finally{m(!1)}},k=({title:g,value:E,icon:z,color:I,trend:d})=>e.jsx(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},whileHover:{scale:1.02},className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:g}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E}),d&&e.jsxs("div",{className:`flex items-center mt-2 text-sm ${d.isPositive?"text-green-600":"text-red-600"}`,children:[e.jsx(ge,{size:16,className:d.isPositive?"":"rotate-180"}),e.jsxs("span",{className:"ml-1",children:[d.value,"%"]})]})]}),e.jsx("div",{className:`${I} p-3 rounded-lg`,children:e.jsx(z,{className:"h-6 w-6 text-white"})})]})});return a?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Booking Analytics"}),e.jsx("p",{className:"text-gray-600",children:"Track booking patterns and user behavior"})]}),e.jsxs("select",{value:c,onChange:g=>b(g.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"week",children:"Last 7 Days"}),e.jsx("option",{value:"month",children:"Last 30 Days"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(k,{title:"Total Bookings",value:s.totalBookings,icon:J,color:"bg-blue-500",trend:{value:12,isPositive:!0}}),e.jsx(k,{title:`${c==="week"?"Weekly":"Monthly"} Bookings`,value:s.weeklyBookings,icon:fs,color:"bg-green-500",trend:{value:8,isPositive:!0}}),e.jsx(k,{title:"Most Active Shop",value:s.mostActiveShop,icon:Ie,color:"bg-purple-500"}),e.jsx(k,{title:"Average Distance",value:`${s.averageDistance}km`,icon:Ce,color:"bg-orange-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(J,{className:"mr-2 text-blue-600",size:20}),"Most Booked Items"]}),e.jsx("div",{className:"space-y-3",children:s.topItems.length>0?s.topItems.map((g,E)=>e.jsxs(T.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:E*.1},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:g.name}),e.jsx("p",{className:"text-sm text-gray-600",children:g.shopName})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-lg font-bold text-blue-600",children:g.count}),e.jsx("p",{className:"text-xs text-gray-500",children:"bookings"})]})]},g.name)):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No booking data available"})})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ie,{className:"mr-2 text-green-600",size:20}),"Most Active Shops"]}),e.jsx("div",{className:"space-y-3",children:s.topShops.length>0?s.topShops.map((g,E)=>e.jsxs(T.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:E*.1},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:g.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[g.distance," away"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-lg font-bold text-green-600",children:g.bookings}),e.jsx("p",{className:"text-xs text-gray-500",children:"bookings"})]})]},g.name)):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No booking data available"})})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(Re,{className:"mr-2 text-purple-600",size:20}),"Recent Bookings"]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:s.recentBookings.length>0?s.recentBookings.map((g,E)=>{var z;return e.jsx(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:E*.05},className:"p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:g.shopName}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[e.jsxs("p",{children:["User ID: ",g.uid]}),e.jsxs("p",{children:["User: ",g.userWhatsApp]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs ${g.status==="confirmed"?"bg-green-100 text-green-800":g.status==="cancelled"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:g.status}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:(z=g.timestamp)==null?void 0:z.toDate().toLocaleDateString()})]})]})},g.id)}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Re,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No recent bookings"})]})})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6 border border-blue-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"ЁЯУК Key Insights"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-white/50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"ЁЯФе Most Popular Item"}),e.jsxs("p",{className:"text-gray-700",children:[e.jsx("strong",{children:s.mostBookedItem})," is the most frequently booked item across all shops."]})]}),e.jsxs("div",{className:"bg-white/50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"ЁЯПк Top Performing Shop"}),e.jsxs("p",{className:"text-gray-700",children:[e.jsx("strong",{children:s.mostActiveShop})," receives the most bookings from customers."]})]}),e.jsxs("div",{className:"bg-white/50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"ЁЯУН Customer Reach"}),e.jsxs("p",{className:"text-gray-700",children:["Average customer distance is ",e.jsxs("strong",{children:[s.averageDistance,"km"]}),", showing good local reach."]})]}),e.jsxs("div",{className:"bg-white/50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"ЁЯУИ Growth Trend"}),e.jsxs("p",{className:"text-gray-700",children:["Booking activity has increased by ",e.jsx("strong",{children:"12%"})," in the selected time period."]})]})]})]})]})},Hs=()=>{const[s,i]=h.useState([]),[a,m]=h.useState(!0),[c,b]=h.useState(!1),[y,k]=h.useState(null),[g,E]=h.useState({name:"",hindi_name:"",icon:"",description:"",isActive:!0});h.useEffect(()=>{z()},[]);const z=async()=>{try{const x=await we();i(x)}catch(x){console.error("Error fetching categories:",x),p.error("Failed to fetch categories")}finally{m(!1)}},I=async x=>{x.preventDefault();const n=Ts(g);if(n.length>0){p.error(n.join(", "));return}m(!0);try{y?(await me(y.id,g),p.success("Category updated successfully!")):(await Cs(g),p.success("Category added successfully!")),await z();try{await Te(),p.success("Shop categories synchronized successfully!")}catch(j){console.error("Error syncing shop categories:",j),p.warn("Category saved but shop synchronization failed")}C()}catch(j){console.error("Error saving category:",j),p.error("Failed to save category")}finally{m(!1)}},d=x=>{k(x),E({name:x.name,hindi_name:x.hindi_name||"",icon:x.icon||"",description:x.description||"",isActive:x.isActive}),b(!0)},D=async x=>{if(confirm("Are you sure you want to delete this category?"))try{await As(x),p.success("Category deleted successfully!"),await z()}catch(n){console.error("Error deleting category:",n),p.error("Failed to delete category")}},P=async()=>{if(confirm("This will validate and sync all shop categories. Continue?")){m(!0);try{await Te(),p.success("Shop categories synchronized successfully!")}catch(x){console.error("Error syncing shop categories:",x),p.error("Failed to sync shop categories")}finally{m(!1)}}},O=async x=>{try{await me(x.id,{isActive:!x.isActive}),p.success(`Category ${x.isActive?"deactivated":"activated"} successfully!`),await z()}catch(n){console.error("Error toggling category status:",n),p.error("Failed to update category status")}},S=async()=>{if(confirm("This will add default categories if none exist. Continue?"))try{m(!0),await Is(),p.success("Default categories initialized successfully!"),await z()}catch(x){console.error("Error initializing default categories:",x),p.error("Failed to initialize default categories")}finally{m(!1)}},$=async(x,n)=>{const j=s.findIndex(N=>N.id===x);if(j===-1)return;const H=n==="up"?j-1:j+1;if(!(H<0||H>=s.length))try{const N=s[j],l=s[H];await me(N.id,{sortOrder:l.sortOrder}),await me(l.id,{sortOrder:N.sortOrder}),p.success("Category order updated successfully!"),await z()}catch(N){console.error("Error reordering categories:",N),p.error("Failed to reorder categories")}},C=()=>{E({name:"",hindi_name:"",icon:"",description:"",isActive:!0}),k(null),b(!1)};return a&&s.length===0?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Category Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage shop categories for better organization"})]}),e.jsxs("div",{className:"flex space-x-3",children:[s.length===0&&e.jsxs("button",{onClick:S,disabled:a,className:"flex items-center space-x-2 bg-green-600 text-white px-4 py-2 rounded-xl hover:bg-green-700 transition-colors disabled:opacity-50",children:[e.jsx(ie,{size:20}),e.jsx("span",{children:"Initialize Defaults"})]}),e.jsxs("button",{onClick:P,disabled:a,className:"flex items-center space-x-2 bg-purple-600 text-white px-4 py-2 rounded-xl hover:bg-purple-700 transition-colors disabled:opacity-50",children:[e.jsx(Ae,{size:20}),e.jsx("span",{children:"Sync Shops"})]}),e.jsxs("button",{onClick:()=>b(!0),className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-xl hover:bg-blue-700 transition-colors",children:[e.jsx(ie,{size:20}),e.jsx("span",{children:"Add Category"})]})]})]}),c&&e.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:y?"Edit Category":"Add New Category"}),e.jsx("button",{onClick:C,className:"text-gray-400 hover:text-gray-600",children:e.jsx(ae,{size:24})})]}),e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category Name *"}),e.jsx("input",{type:"text",value:g.name,onChange:x=>E(n=>({...n,name:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Electronics & Mobile",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hindi Name"}),e.jsx("input",{type:"text",value:g.hindi_name,onChange:x=>E(n=>({...n,hindi_name:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., рдЗрд▓реЗрдХреНрдЯреНрд░реЙрдирд┐рдХреНрд╕ рдФрд░ рдореЛрдмрд╛рдЗрд▓"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Icon (Emoji)"}),e.jsx("input",{type:"text",value:g.icon,onChange:x=>E(n=>({...n,icon:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., ЁЯУ▒"})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:g.isActive,onChange:x=>E(n=>({...n,isActive:x.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Active Category"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:g.description,onChange:x=>E(n=>({...n,description:x.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Brief description of this category..."})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{type:"submit",disabled:a,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:a?"Saving...":y?"Update Category":"Add Category"}),e.jsx("button",{type:"button",onClick:C,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Categories (",s.length,")"]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:s.map((x,n)=>{var j,H,N;return e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[x.icon&&e.jsx("span",{className:"text-2xl",children:x.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:x.name}),x.hindi_name&&e.jsx("p",{className:"text-sm text-gray-600",children:x.hindi_name})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${x.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:x.isActive?"Active":"Inactive"}),e.jsxs("span",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded-full text-xs",children:["Order: ",x.sortOrder]})]})]}),x.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:x.description}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Created: ",((N=(H=(j=x.createdAt)==null?void 0:j.toDate)==null?void 0:H.call(j))==null?void 0:N.toLocaleDateString())||"N/A"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("button",{onClick:()=>$(x.id,"up"),disabled:n===0,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30 disabled:cursor-not-allowed",title:"Move up",children:e.jsx(Ae,{size:14})}),e.jsx("button",{onClick:()=>$(x.id,"down"),disabled:n===s.length-1,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30 disabled:cursor-not-allowed",title:"Move down",children:e.jsx(Ge,{size:14})})]}),e.jsx("button",{onClick:()=>O(x),className:`p-2 rounded-lg transition-colors ${x.isActive?"text-orange-600 hover:bg-orange-50":"text-green-600 hover:bg-green-50"}`,title:x.isActive?"Deactivate":"Activate",children:x.isActive?e.jsx(Ee,{size:16}):e.jsx(fe,{size:16})}),e.jsx("button",{onClick:()=>d(x),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:e.jsx(Ne,{size:16})}),e.jsx("button",{onClick:()=>D(x.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:e.jsx(je,{size:16})})]})]})},x.id)})}),s.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-500 mb-4",children:"No categories found."}),e.jsx("button",{onClick:S,disabled:a,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:"Initialize Default Categories"})]})]})]})},Rs=async()=>{try{const s=Q(U,"trendingItems"),i=Ve(s,pe("priority","desc"),pe("createdAt","desc"));return(await le(i)).docs.map(m=>({id:m.id,...m.data()}))}catch(s){return console.error("Error fetching trending items:",s),[]}},Bs=async s=>{try{if(!(await G()).isAdmin)throw new Error("Admin access required");const a=Q(U,"trendingItems");return(await Le(a,{...s,priority:s.priority??1,isActive:s.isActive??!0,createdAt:W(),updatedAt:W()})).id}catch(i){throw console.error("Error adding trending item:",i),i}},Ms=async(s,i)=>{try{if(!(await G()).isAdmin)throw new Error("Admin access required");const m=ne(U,"trendingItems",s);await ve(m,{...i,updatedAt:W()})}catch(a){throw console.error("Error updating trending item:",a),a}},qs=async s=>{try{if(!(await G()).isAdmin)throw new Error("Admin access required");const a=ne(U,"trendingItems",s);await We(a)}catch(i){throw console.error("Error deleting trending item:",i),i}},Os=async s=>{try{if(!(await G()).isAdmin)throw new Error("Admin access required");const a=ne(U,"trendingItems",s),m=await Ns(a);if(m.exists()){const c=m.data();await ve(a,{isActive:!c.isActive,updatedAt:W()})}}catch(i){throw console.error("Error toggling trending item status:",i),i}},Us=async(s,i)=>{try{if(!(await G()).isAdmin)throw new Error("Admin access required");const m=ne(U,"trendingItems",s);await ve(m,{priority:i,updatedAt:W()})}catch(a){throw console.error("Error setting trending item priority:",a),a}},Vs=()=>{const[s,i]=h.useState([]),[a,m]=h.useState([]),[c,b]=h.useState([]),[y,k]=h.useState(!0),[g,E]=h.useState(!1),[z,I]=h.useState(null),[d,D]=h.useState(""),[P,O]=h.useState(""),[S,$]=h.useState({itemId:"",shopId:"",itemName:"",shopName:"",category:"",priority:1,isActive:!0});h.useEffect(()=>{C()},[]),h.useEffect(()=>{S.shopId&&x(S.shopId)},[S.shopId]);const C=async()=>{var o;try{k(!0);const[A,F]=await Promise.all([Rs(),Y(!0)]);i(A),m(F)}catch(A){console.error("Error fetching data:",A),(o=A.message)!=null&&o.includes("Missing or insufficient permissions")?p.error("Permission error: Please check Firestore rules for trendingItems collection"):p.error("Failed to fetch data")}finally{k(!1)}},x=async o=>{try{const A=await ze(o);b(A)}catch(A){console.error("Error fetching items:",A),p.error("Failed to fetch items")}},n=async o=>{if(o.preventDefault(),!S.itemId||!S.shopId){p.error("Please select both shop and item");return}try{z?(await Ms(z.id,S),p.success("Trending item updated successfully!")):(await Bs(S),p.success("Trending item added successfully!")),f(),await C()}catch(A){console.error("Error saving trending item:",A),p.error("Failed to save trending item")}},j=o=>{I(o),$({itemId:o.itemId,shopId:o.shopId,itemName:o.itemName,shopName:o.shopName,category:o.category||"",priority:o.priority,isActive:o.isActive}),E(!0)},H=async o=>{if(confirm("Are you sure you want to remove this trending item?"))try{await qs(o),p.success("Trending item removed successfully!"),await C()}catch(A){console.error("Error deleting trending item:",A),p.error("Failed to remove trending item")}},N=async o=>{try{await Os(o),p.success("Trending item status updated!"),await C()}catch(A){console.error("Error toggling status:",A),p.error("Failed to update status")}},l=async(o,A)=>{try{await Us(o,A),p.success("Priority updated!"),await C()}catch(F){console.error("Error updating priority:",F),p.error("Failed to update priority")}},f=()=>{$({itemId:"",shopId:"",itemName:"",shopName:"",category:"",priority:1,isActive:!0}),I(null),E(!1),b([])},w=o=>{const A=a.find(F=>F.id===o);$(F=>({...F,shopId:o,shopName:(A==null?void 0:A.shopName)||"",itemId:"",itemName:""}))},L=o=>{const A=c.find(F=>F.id===o);$(F=>({...F,itemId:o,itemName:(A==null?void 0:A.name)||"",category:(A==null?void 0:A.category)||""}))},q=s.filter(o=>{var A;return o.itemName.toLowerCase().includes(d.toLowerCase())||o.shopName.toLowerCase().includes(d.toLowerCase())||((A=o.category)==null?void 0:A.toLowerCase().includes(d.toLowerCase()))});return y?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ge,{className:"text-orange-500",size:32}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Trending Items"}),e.jsx("p",{className:"text-gray-600",children:'Manage trending items for "Trending Near You" section'})]})]}),e.jsxs("button",{onClick:()=>E(!0),className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-xl hover:bg-blue-700 transition-colors",children:[e.jsx(ie,{size:20}),e.jsx("span",{children:"Add Trending Item"})]})]}),e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-200",children:e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search trending items...",value:d,onChange:o=>D(o.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),e.jsx(oe,{children:g&&e.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:z?"Edit Trending Item":"Add Trending Item"}),e.jsx("button",{onClick:f,className:"text-gray-400 hover:text-gray-600",children:e.jsx(ae,{size:24})})]}),e.jsxs("form",{onSubmit:n,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Shop *"}),e.jsxs("select",{value:S.shopId,onChange:o=>w(o.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Choose a shop"}),a.map(o=>e.jsxs("option",{value:o.id,children:[o.shopName," (",o.type,")"]},o.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Item *"}),e.jsxs("select",{value:S.itemId,onChange:o=>L(o.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:!S.shopId,children:[e.jsx("option",{value:"",children:"Choose an item"}),c.map(o=>e.jsxs("option",{value:o.id,children:[o.name," ",o.category&&`(${o.category})`]},o.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority (1-10)"}),e.jsx("input",{type:"number",min:"1",max:"10",value:S.priority,onChange:o=>$(A=>({...A,priority:parseInt(o.target.value)||1})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Higher numbers appear first"})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:S.isActive,onChange:o=>$(A=>({...A,isActive:o.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Active"})]})})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:z?"Update Item":"Add Item"}),e.jsx("button",{type:"button",onClick:f,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Trending Items (",q.length,")"]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:q.length>0?q.map((o,A)=>{var F,_,t;return e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx(ye,{className:"text-orange-500",size:20}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:o.itemName}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs",children:["Priority: ",o.priority]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:o.isActive?"Active":"Inactive"})]})]}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Shop:"})," ",o.shopName]}),o.category&&e.jsxs("p",{children:[e.jsx("strong",{children:"Category:"})," ",o.category]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Added:"})," ",((t=(_=(F=o.createdAt)==null?void 0:F.toDate)==null?void 0:_.call(F))==null?void 0:t.toLocaleDateString())||"N/A"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("button",{onClick:()=>l(o.id,o.priority+1),disabled:o.priority>=10,className:"p-1 text-gray-400 hover:text-blue-600 disabled:opacity-30 disabled:cursor-not-allowed",title:"Increase priority",children:e.jsx(Ae,{size:14})}),e.jsx("button",{onClick:()=>l(o.id,o.priority-1),disabled:o.priority<=1,className:"p-1 text-gray-400 hover:text-blue-600 disabled:opacity-30 disabled:cursor-not-allowed",title:"Decrease priority",children:e.jsx(Ge,{size:14})})]}),e.jsx("button",{onClick:()=>N(o.id),className:`p-2 rounded-lg transition-colors ${o.isActive?"text-orange-600 hover:bg-orange-50":"text-green-600 hover:bg-green-50"}`,title:o.isActive?"Deactivate":"Activate",children:o.isActive?e.jsx(Ee,{size:16}):e.jsx(fe,{size:16})}),e.jsx("button",{onClick:()=>j(o),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:e.jsx(Ne,{size:16})}),e.jsx("button",{onClick:()=>H(o.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:e.jsx(je,{size:16})})]})]})},o.id)}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ge,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No trending items found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:d?"Try adjusting your search":"Start by adding your first trending item"}),e.jsx("button",{onClick:()=>E(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Add First Item"})]})})]})]})},Ws=()=>{const[s,i]=h.useState(null),[a,m]=h.useState(!1),c=async()=>{m(!0);try{const[y,k,g]=await Promise.all([Y(!0),ke(),Qe()]),E=y.filter(S=>!S.isHidden),z=y.filter(S=>S.isHidden),I=y.filter(S=>!S.type||!S.type.trim()),d=k.map(S=>S.name.toLowerCase()),D=y.filter(S=>S.type&&S.type.trim()&&!d.includes(S.type.toLowerCase())),P=g.filter(S=>!d.includes(S.toLowerCase())),O={totalShops:y.length,visibleShops:E.length,hiddenShops:z.length,shopsWithoutCategory:I.length,shopsWithInvalidCategory:D.length,uniqueCategories:g,missingCategories:P};i(O),p.success("Diagnostics completed successfully!")}catch(y){console.error("Error running diagnostics:",y),p.error("Failed to run diagnostics")}finally{m(!1)}},b=async()=>{if(confirm("This will validate and fix all shop categories. Continue?")){m(!0);try{await Te(),p.success("Shop categories fixed successfully!"),await c()}catch(y){console.error("Error fixing shop categories:",y),p.error("Failed to fix shop categories")}finally{m(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Shop Diagnostics"}),e.jsx("p",{className:"text-gray-600",children:"Diagnose and fix shop visibility issues"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:c,disabled:a,className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-xl hover:bg-blue-700 transition-colors disabled:opacity-50",children:[e.jsx(Z,{size:20}),e.jsx("span",{children:"Run Diagnostics"})]}),s&&s.shopsWithInvalidCategory>0&&e.jsxs("button",{onClick:b,disabled:a,className:"flex items-center space-x-2 bg-green-600 text-white px-4 py-2 rounded-xl hover:bg-green-700 transition-colors disabled:opacity-50",children:[e.jsx(be,{size:20}),e.jsx("span",{children:"Fix Categories"})]})]})]}),a&&e.jsxs(T.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white rounded-2xl p-8 shadow-lg border border-gray-200 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Running diagnostics..."})]}),s&&!a&&e.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Shops"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:s.totalShops})]}),e.jsx("div",{className:"bg-blue-100 p-3 rounded-xl",children:e.jsx(Z,{className:"text-blue-600",size:24})})]})}),e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Visible Shops"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:s.visibleShops})]}),e.jsx("div",{className:"bg-green-100 p-3 rounded-xl",children:e.jsx(ue,{className:"text-green-600",size:24})})]})}),e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Hidden Shops"}),e.jsx("p",{className:"text-3xl font-bold text-gray-500",children:s.hiddenShops})]}),e.jsx("div",{className:"bg-gray-100 p-3 rounded-xl",children:e.jsx(se,{className:"text-gray-500",size:24})})]})}),e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Invalid Categories"}),e.jsx("p",{className:`text-3xl font-bold ${s.shopsWithInvalidCategory>0?"text-red-600":"text-green-600"}`,children:s.shopsWithInvalidCategory})]}),e.jsx("div",{className:`p-3 rounded-xl ${s.shopsWithInvalidCategory>0?"bg-red-100":"bg-green-100"}`,children:e.jsx(se,{className:s.shopsWithInvalidCategory>0?"text-red-600":"text-green-600",size:24})})]})})]}),(s.shopsWithoutCategory>0||s.shopsWithInvalidCategory>0||s.missingCategories.length>0)&&e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-200",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Issues Found"}),e.jsxs("div",{className:"space-y-4",children:[s.shopsWithoutCategory>0&&e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-yellow-50 rounded-xl border border-yellow-200",children:[e.jsx(se,{className:"text-yellow-600",size:20}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-yellow-800",children:[s.shopsWithoutCategory," shops without category"]}),e.jsx("p",{className:"text-sm text-yellow-700",children:"These shops don't have a category assigned and may not appear in category filters."})]})]}),s.shopsWithInvalidCategory>0&&e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-red-50 rounded-xl border border-red-200",children:[e.jsx(se,{className:"text-red-600",size:20}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-red-800",children:[s.shopsWithInvalidCategory," shops with invalid categories"]}),e.jsx("p",{className:"text-sm text-red-700",children:"These shops have categories that don't exist in the categories collection."})]})]}),s.missingCategories.length>0&&e.jsxs("div",{className:"flex items-start space-x-3 p-4 bg-blue-50 rounded-xl border border-blue-200",children:[e.jsx(se,{className:"text-blue-600 mt-0.5",size:20}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-blue-800",children:[s.missingCategories.length," categories used by shops but not in categories collection"]}),e.jsx("p",{className:"text-sm text-blue-700 mb-2",children:"These categories should be added to the categories collection:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.missingCategories.map((y,k)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:y},k))})]})]})]})]}),s.shopsWithoutCategory===0&&s.shopsWithInvalidCategory===0&&s.missingCategories.length===0&&e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-green-50 rounded-xl border border-green-200",children:[e.jsx(ue,{className:"text-green-600",size:24}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-800",children:"All shops are properly configured!"}),e.jsx("p",{className:"text-sm text-green-700",children:"No issues found with shop categories or visibility."})]})]})}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-200",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Categories Overview"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Categories used by shops:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.uniqueCategories.map((y,k)=>e.jsx("span",{className:"bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm",children:y},k))})]})})]})]}),!s&&!a&&e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg border border-gray-200 text-center",children:[e.jsx(Z,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Shop Diagnostics"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Run diagnostics to check for shop visibility issues and category problems."}),e.jsx("button",{onClick:c,className:"bg-blue-600 text-white px-6 py-3 rounded-xl hover:bg-blue-700 transition-colors",children:"Run Diagnostics"})]})]})},Gs=()=>{const{user:s,loading:i}=Oe(),[a,m]=h.useState(!1),[c,b]=h.useState({isValid:!1});return h.useEffect(()=>{if(i)return;(async()=>{if(s)try{const k=await G();m(k.isAdmin),b({isValid:k.isAdmin,reason:k.isAdmin?void 0:"Insufficient permissions"})}catch{m(!1),b({isValid:!1,reason:"Failed to validate permissions"})}else m(!1),b({isValid:!1,reason:"User not authenticated"})})()},[s,i]),{isAdmin:a,validation:c,loading:i,user:s}},tt=()=>{const[s,i]=h.useState("overview"),[a,m]=h.useState({totalShops:0,totalItems:0,totalBookings:0,totalReviews:0,totalCategories:0,loading:!0}),[c,b]=h.useState([]),{isAdmin:y,validation:k,loading:g,user:E}=Gs();h.useEffect(()=>{!g&&y&&k.isValid&&z()},[g,y,k,E]);const z=async()=>{try{m(f=>({...f,loading:!0}));const[n,j,H]=await Promise.all([I(),D(),P()]),N=await d(n.shops),l=await O();m({totalShops:n.totalShops,totalItems:N.totalItems,totalBookings:j.totalBookings,totalReviews:H.totalReviews,totalCategories:N.totalCategories,loading:!1}),b(l)}catch(n){console.error("Error loading dashboard data:",n),m(j=>({...j,loading:!1}))}},I=async()=>{try{const n=await Y(!0);return{shops:n,totalShops:n.length}}catch(n){return console.error("Error fetching shops:",n),{shops:[],totalShops:0}}},d=async n=>{try{let j=0;const H=new Set;for(const N of n)try{const l=await ze(N.id,void 0,!0);j+=l.length,l.forEach(f=>{f.category&&f.category.trim()&&H.add(f.category.trim())})}catch(l){console.error(`Error fetching items for shop ${N.id}:`,l)}try{const N=Q(U,"categories");(await le(N)).forEach(f=>{const w=f.data();w.name&&w.name.trim()&&H.add(w.name.trim())})}catch(N){console.error("Error fetching categories collection:",N)}return{totalItems:j,totalCategories:H.size}}catch(j){return console.error("Error fetching items data:",j),{totalItems:0,totalCategories:0}}},D=async()=>{try{const n=Q(U,"bookings");return{totalBookings:(await le(n)).size}}catch(n){return n.code==="permission-denied"?{totalBookings:0}:(console.error("Error fetching bookings:",n),{totalBookings:0})}},P=async()=>{try{const n=Q(U,"reviews");return{totalReviews:(await le(n)).size}}catch(n){return n.code==="permission-denied"?{totalReviews:0}:(console.error("Error fetching reviews:",n),{totalReviews:0})}},O=async()=>{try{const n=[];return n.push({type:"info",description:"Dashboard loaded successfully",time:"now",icon:ee},{type:"system",description:"Admin panel ready",time:"1 min ago",icon:xe},{type:"shop",description:"Shop management available",time:"2 min ago",icon:re},{type:"item",description:"Item management ready",time:"3 min ago",icon:J}),n}catch(n){return console.error("Error fetching recent activity:",n),[{type:"info",description:"Welcome to your dashboard",time:"now",icon:ee},{type:"system",description:"System ready for management",time:"1 min ago",icon:xe}]}},S=n=>n>=1e3?`${(n/1e3).toFixed(1)}K`:n.toString(),$=[{id:"overview",label:"Overview",icon:ee,badge:null,color:"from-violet-500 to-purple-600"},{id:"shops",label:"Shops",icon:re,badge:a.loading?"...":a.totalShops.toString(),color:"from-blue-500 to-cyan-600"},{id:"items",label:"Items",icon:J,badge:a.loading?"...":S(a.totalItems),color:"from-emerald-500 to-teal-600"},{id:"categories",label:"Categories",icon:Be,badge:a.loading?"...":a.totalCategories.toString(),color:"from-pink-500 to-rose-600"},{id:"trending",label:"Trending",icon:ge,badge:null,color:"from-amber-500 to-yellow-600"},{id:"analytics",label:"Analytics",icon:Ie,badge:null,color:"from-indigo-500 to-blue-600"},{id:"diagnostics",label:"Diagnostics",icon:xe,badge:null,color:"from-teal-500 to-cyan-600"}],C=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsxs(T.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"relative overflow-hidden bg-gradient-to-r from-violet-600 via-purple-600 to-indigo-600 rounded-2xl sm:rounded-3xl p-6 sm:p-8 text-white shadow-2xl",children:[e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-3 sm:space-y-0 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"bg-white/20 backdrop-blur-sm p-2 sm:p-3 rounded-xl sm:rounded-2xl",children:e.jsx(De,{className:"text-white w-5 h-5 sm:w-6 sm:h-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold",children:"Welcome back!"}),e.jsx("p",{className:"text-purple-100 text-sm sm:text-base",children:"Here's what's happening with your platform today"})]})]}),e.jsxs(T.button,{onClick:z,whileHover:{scale:1.05},whileTap:{scale:.95},disabled:a.loading,className:"flex items-center space-x-2 bg-white/20 backdrop-blur-sm text-white px-4 py-2 rounded-xl hover:bg-white/30 transition-all duration-300 disabled:opacity-50",children:[e.jsx(be,{className:`w-4 h-4 ${a.loading?"animate-spin":""}`}),e.jsx("span",{className:"text-sm font-medium",children:"Refresh"})]})]})}),e.jsx("div",{className:"absolute top-0 right-0 w-32 sm:w-64 h-32 sm:h-64 bg-white/10 rounded-full blur-2xl sm:blur-3xl -translate-y-16 sm:-translate-y-32 translate-x-16 sm:translate-x-32"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-24 sm:w-48 h-24 sm:h-48 bg-white/10 rounded-full blur-2xl sm:blur-3xl translate-y-12 sm:translate-y-24 -translate-x-12 sm:-translate-x-24"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 sm:gap-6",children:[{title:"Total Shops",value:a.totalShops,icon:re,color:"from-blue-500 via-blue-600 to-cyan-600",bgPattern:"bg-blue-50",iconBg:"bg-blue-500"},{title:"Total Items",value:a.totalItems,icon:J,color:"from-emerald-500 via-green-600 to-teal-600",bgPattern:"bg-emerald-50",iconBg:"bg-emerald-500"},{title:"Total Bookings",value:a.totalBookings,icon:vs,color:"from-orange-500 via-amber-600 to-yellow-600",bgPattern:"bg-orange-50",iconBg:"bg-orange-500"},{title:"Total Reviews",value:a.totalReviews,icon:ye,color:"from-purple-500 via-violet-600 to-indigo-600",bgPattern:"bg-purple-50",iconBg:"bg-purple-500"},{title:"Categories",value:a.totalCategories,icon:Be,color:"from-pink-500 via-rose-600 to-red-600",bgPattern:"bg-pink-50",iconBg:"bg-pink-500"}].map((n,j)=>e.jsxs(T.div,{initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},transition:{delay:j*.1,type:"spring",bounce:.3},whileHover:{y:-5,scale:1.02},className:"group relative overflow-hidden bg-white/80 backdrop-blur-xl rounded-3xl p-6 shadow-lg border border-white/30 hover:shadow-2xl transition-all duration-500",children:[e.jsx("div",{className:`absolute inset-0 ${n.bgPattern} opacity-30 group-hover:opacity-50 transition-opacity duration-300`}),e.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-gradient-to-br from-white/20 to-transparent rounded-full blur-xl group-hover:scale-150 transition-transform duration-700"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-600 mb-2 tracking-wide uppercase",children:n.title}),a.loading?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-10 w-20 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 rounded-lg animate-pulse"}),e.jsx("div",{className:"h-4 w-16 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 rounded animate-pulse"})]}):e.jsx(T.p,{initial:{scale:0},animate:{scale:1},transition:{delay:.5+j*.1,type:"spring",bounce:.5},className:"text-4xl font-black text-gray-900 mb-3",children:n.value.toLocaleString()})]}),e.jsx(T.div,{whileHover:{rotate:360,scale:1.1},transition:{duration:.6},className:`${n.iconBg} p-4 rounded-2xl shadow-lg group-hover:shadow-xl`,children:e.jsx(n.icon,{className:"text-white",size:28})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"flex items-center space-x-1 px-3 py-1.5 rounded-full bg-blue-100 text-blue-700",children:[e.jsx(ee,{size:14}),e.jsx("span",{className:"text-sm font-bold",children:"Live"})]})}),e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Real-time data"})]})]})]},j))}),e.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-white/80 backdrop-blur-xl rounded-3xl p-8 shadow-xl border border-white/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-emerald-600 p-3 rounded-2xl",children:e.jsx(ee,{className:"text-white",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Recent Activity"}),e.jsx("p",{className:"text-gray-600",children:"Latest platform updates"})]})]}),e.jsxs(T.button,{onClick:z,whileHover:{scale:1.05},whileTap:{scale:.95},disabled:a.loading,className:"flex items-center space-x-2 bg-gradient-to-r from-blue-500 to-indigo-600 text-white px-4 py-2 rounded-xl hover:shadow-lg transition-all duration-300 disabled:opacity-50",children:[e.jsx(be,{className:`${a.loading?"animate-spin":""}`,size:16}),e.jsx("span",{className:"text-sm font-medium",children:"Refresh"})]})]}),e.jsx("div",{className:"space-y-4",children:a.loading?e.jsx("div",{className:"space-y-4",children:[1,2,3,4].map(n=>e.jsxs("div",{className:"flex items-center space-x-4 p-5 rounded-2xl bg-gray-50 animate-pulse",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-xl"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]},n))}):c.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ee,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No recent activity"}),e.jsx("p",{className:"text-gray-600",children:"Activity will appear here as users interact with your platform"})]}):c.map((n,j)=>e.jsxs(T.div,{initial:{opacity:0,x:-20,scale:.9},animate:{opacity:1,x:0,scale:1},transition:{delay:.6+j*.1,type:"spring",bounce:.3},whileHover:{x:5,scale:1.02},className:"group relative overflow-hidden flex items-center space-x-4 p-5 rounded-2xl bg-gradient-to-r from-gray-50 to-white hover:from-white hover:to-gray-50 transition-all duration-300 border border-gray-100 hover:border-gray-200 hover:shadow-lg",children:[e.jsx("div",{className:`p-3 rounded-xl shadow-md ${n.type==="booking"?"bg-gradient-to-br from-orange-400 to-red-500":n.type==="review"?"bg-gradient-to-br from-yellow-400 to-orange-500":n.type==="shop"?"bg-gradient-to-br from-blue-400 to-indigo-500":n.type==="item"?"bg-gradient-to-br from-emerald-400 to-teal-500":n.type==="system"?"bg-gradient-to-br from-purple-400 to-violet-500":"bg-gradient-to-br from-green-400 to-emerald-500"}`,children:e.jsx(n.icon,{className:"text-white",size:18})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-base font-semibold text-gray-900 mb-1",children:n.description}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("p",{className:"text-sm text-gray-600",children:n.time})]})]}),e.jsx(T.button,{whileHover:{scale:1.1},whileTap:{scale:.9},className:"p-2 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-xl transition-all duration-200",children:e.jsx(fe,{size:18})}),e.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 bg-gradient-to-br from-white/60 to-transparent rounded-full blur-sm group-hover:scale-150 transition-transform duration-500"})]},j))}),e.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"mt-6 text-center",children:e.jsx("button",{className:"text-indigo-600 hover:text-indigo-700 font-medium text-sm hover:underline transition-all duration-200",children:"View all activity тЖТ"})})]})]}),x=()=>{switch(s){case"overview":return C();case"shops":return e.jsx(zs,{});case"items":return e.jsx($s,{});case"categories":return e.jsx(Hs,{});case"trending":return e.jsx(Vs,{});case"analytics":return e.jsx(Ps,{});case"diagnostics":return e.jsx(Ws,{});default:return C()}};return g?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Verifying admin access..."})]})}):!y||!k.isValid?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[e.jsx(se,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Insufficient permissions"}),e.jsx("button",{onClick:()=>window.location.href="/admin/login",className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Go to Login"})]})}):e.jsxs(Ss,{title:"Dashboard",subtitle:"Manage shops, items, and platform settings",children:[e.jsxs("div",{className:"relative bg-white/90 backdrop-blur-2xl rounded-3xl p-4 mb-8 border border-white/40 shadow-2xl",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-violet-500/10 via-purple-500/10 to-indigo-500/10 rounded-3xl blur-xl"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"block lg:hidden mb-6",children:e.jsxs(T.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"relative",children:[e.jsx("select",{value:s,onChange:n=>i(n.target.value),className:"w-full bg-gradient-to-r from-white/90 to-white/80 backdrop-blur-xl border border-white/40 rounded-2xl px-6 py-4 text-gray-900 font-semibold focus:outline-none focus:ring-2 focus:ring-violet-500 shadow-lg appearance-none cursor-pointer",children:$.map(n=>e.jsxs("option",{value:n.id,className:"font-medium",children:[n.label," ",n.badge?`(${n.badge})`:""]},n.id))}),e.jsx("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx(T.div,{animate:{rotate:180},transition:{duration:.3},children:e.jsx("svg",{className:"w-5 h-5 text-violet-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})})]})}),e.jsx("div",{className:"hidden sm:block lg:hidden mb-6",children:e.jsx("div",{className:"flex space-x-3 overflow-x-auto pb-4 custom-scrollbar",children:$.map((n,j)=>e.jsxs(T.button,{onClick:()=>i(n.id),initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:j*.05},whileHover:{scale:1.05},whileTap:{scale:.95},className:`flex-shrink-0 flex items-center space-x-2 px-4 py-3 rounded-2xl font-semibold transition-all duration-300 ${s===n.id?`bg-gradient-to-r ${n.color} text-white shadow-lg`:"text-gray-700 hover:bg-white/80 hover:text-gray-900 bg-white/60"}`,children:[e.jsx(n.icon,{size:18}),e.jsx("span",{className:"text-sm whitespace-nowrap",children:n.label}),n.badge&&e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold ${s===n.id?"bg-white/25 text-white":"bg-violet-100 text-violet-700"}`,children:n.badge})]},n.id))})}),e.jsx("div",{className:"hidden lg:flex flex-wrap gap-3",children:$.map((n,j)=>e.jsxs(T.button,{onClick:()=>i(n.id),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:j*.05},whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},className:`group relative flex items-center space-x-3 px-6 py-4 rounded-2xl font-semibold transition-all duration-300 ${s===n.id?`bg-gradient-to-r ${n.color} text-white shadow-2xl shadow-violet-500/25`:"text-gray-700 hover:bg-white/80 hover:text-gray-900 hover:shadow-lg"}`,children:[e.jsx(T.div,{whileHover:{rotate:s===n.id?0:360},transition:{duration:.6},children:e.jsx(n.icon,{size:20})}),e.jsx("span",{className:"text-sm font-bold tracking-wide",children:n.label}),n.badge&&e.jsx(T.span,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",bounce:.5},className:`px-3 py-1 rounded-full text-xs font-bold ${s===n.id?"bg-white/25 text-white backdrop-blur-sm":"bg-gradient-to-r from-violet-100 to-purple-100 text-violet-700"}`,children:n.badge}),s===n.id&&e.jsxs(e.Fragment,{children:[e.jsx(T.div,{layoutId:"activeTabGlow",className:`absolute inset-0 bg-gradient-to-r ${n.color} rounded-2xl -z-10`,transition:{type:"spring",bounce:.2,duration:.6}}),e.jsx(T.div,{layoutId:"activeTabBlur",className:`absolute inset-0 bg-gradient-to-r ${n.color} rounded-2xl blur-lg opacity-50 -z-20`,transition:{type:"spring",bounce:.2,duration:.6}})]}),e.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${n.color} rounded-2xl opacity-0 group-hover:opacity-10 transition-opacity duration-300 -z-10`})]},n.id))})]})]}),e.jsx(oe,{mode:"wait",children:e.jsx(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,ease:"easeInOut"},children:x()},s)})]})};export{tt as default};
