import{c as O,W as K,u as V,Y as J,a0 as oe,j as e,Z as D,$ as I,M as W,k as L,a as B,P as X,a1 as _,_ as U,a2 as H,O as ee,a3 as se,a4 as F,U as de,J as xe,h as G,a5 as Q,X as te,a6 as me,a7 as he,s as ue,G as pe,S as ge,a8 as be,a9 as ae,w as q,aa as Y,ab as re,C as ie,ac as ne,x as Z,ad as fe,T as je,ae as ye}from"./index-CoRpFcO_.js";import{r as d}from"./vendor-ByojS96y.js";import{toast as C}from"./utils-dW3-0Dkj.js";import{u as le,A as ce,m as p,b as ve}from"./ui-JBksMQam.js";import"./firebase-CHM_3GU8.js";import{T as Ne}from"./tag-DCFC4n7Q.js";import{P as we}from"./plus-BcViIRHA.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=O("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=O("ChefHat",[["path",{d:"M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z",key:"z3ra2g"}],["line",{x1:"6",x2:"18",y1:"17",y2:"17",key:"12q60k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=O("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=O("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]),Re=({shop:a})=>{var P;const[o,t]=d.useState([]),[u,c]=d.useState(""),[n,y]=d.useState(""),[g,$]=d.useState(!0),[f,S]=d.useState([]),[w,j]=d.useState(!1),{t:x,i18n:l}=K(),{user:m}=V(),k=le(),v=J(a.openingTime||"",a.closingTime||"");d.useEffect(()=>{z()},[a.id]);const z=async()=>{try{const s=await oe(a.id,"menu");t(s),s.length>0&&c(s[0].name)}catch(s){console.error("Error fetching menu items:",s)}finally{$(!1)}},b=((P=o.find(s=>s.name===u))==null?void 0:P.items.filter(s=>{var r;return s.name.toLowerCase().includes(n.toLowerCase())||((r=s.description)==null?void 0:r.toLowerCase().includes(n.toLowerCase()))}))||[],N=async s=>{if(!m){C.error("Please login to add items to bag");return}j(!0);try{await se({itemId:s.id||`${a.id}-${s.name}`,itemName:s.name,shopId:a.id,shopName:a.shopName,quantity:1,unit:s.unit||"piece",price:s.price}),S(r=>[...r,s]),C.success(`${s.name} added to bag!`)}catch(r){console.error("Error adding to bag:",r),C.error("Failed to add item to bag")}finally{j(!1)}},R=()=>{switch(a.type){case"restaurant":return"🍽️";case"cafe":return"☕";case"hotel":return"🏨";default:return"🍽️"}},A=s=>{const r={starters:"🥗",appetizers:"🥗",soup:"🍲",soups:"🍲","main course":"🍛",mains:"🍛",rice:"🍚",biryani:"🍚",bread:"🍞",roti:"🫓",naan:"🫓",desserts:"🧁",sweets:"🍰",beverages:"🥤",drinks:"🥤",tea:"☕",coffee:"☕",juice:"🧃",snacks:"🍿",chinese:"🥢",indian:"🍛",continental:"🍽️",italian:"🍝",pizza:"🍕",burger:"🍔",sandwich:"🥪",salad:"🥗",default:"🍽️"},i=s.toLowerCase();return r[i]||r.default};return g?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600"})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 to-red-50",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"h-64 md:h-80 overflow-hidden",children:[e.jsx("img",{src:a.imageUrl||"https://images.pexels.com/photos/262978/pexels-photo-262978.jpeg?auto=compress&cs=tinysrgb&w=800",alt:a.shopName,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"})]}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-6 text-white",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("span",{className:"text-3xl",children:R()}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:a.shopName}),e.jsxs("p",{className:"text-orange-200 capitalize",children:[a.type," • ",x("restaurant.indianCuisine")]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(I,{size:16}),e.jsx("span",{className:v.isOpen?"text-green-200":"text-red-200",children:v.status})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(W,{size:16}),e.jsx("span",{children:a.address})]}),D(a.ratings)&&a.ratings.length>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(L,{size:16,className:"fill-current text-yellow-400"}),e.jsx("span",{children:(a.ratings.reduce((s,r)=>s+r,0)/a.ratings.length).toFixed(1)})]})]})]})]}),e.jsx("div",{className:"sticky top-0 bg-white/90 backdrop-blur-md border-b border-gray-200 z-40",children:e.jsxs("div",{className:"px-4 py-4",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx(B,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:x("restaurant.searchMenu"),value:n,onChange:s=>y(s.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-orange-500 bg-white"})]}),e.jsx("div",{className:"flex space-x-2 overflow-x-auto pb-2",children:o.map(s=>e.jsxs("button",{onClick:()=>c(s.name),className:`flex items-center space-x-2 px-4 py-2 rounded-xl whitespace-nowrap transition-colors ${u===s.name?"bg-orange-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx("span",{className:"text-lg",children:A(s.name)}),e.jsx("span",{className:"font-medium",children:s.name}),e.jsx("span",{className:"text-xs bg-white/20 px-2 py-1 rounded-full",children:s.items.length})]},s.name))})]})}),e.jsxs("div",{className:"px-4 py-6",children:[o.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ce,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:x("restaurant.menuNotAvailable")}),e.jsx("p",{className:"text-gray-600 mb-6",children:x("restaurant.contactForMenu")}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsxs("a",{href:`tel:${a.phone}`,className:"flex items-center space-x-2 bg-blue-600 text-white px-6 py-3 rounded-xl hover:bg-blue-700 transition-colors",children:[e.jsx(X,{size:18}),e.jsx("span",{children:x("restaurant.call")})]}),e.jsxs("a",{href:`https://wa.me/${a.phone.replace(/[^0-9]/g,"")}?text=${encodeURIComponent(x("restaurant.whatsappMessage",{shopName:a.shopName}))}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2 bg-green-600 text-white px-6 py-3 rounded-xl hover:bg-green-700 transition-colors",children:[e.jsx(_,{size:18}),e.jsx("span",{children:x("restaurant.whatsapp")})]})]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.jsx(ce,{mode:"wait",children:b.map((s,r)=>e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:r*.1},className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-200 hover:shadow-xl transition-all",children:[e.jsx("div",{className:"flex justify-between items-start mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:A(s.category)}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:U(s.name,s.hindi_name,l.language)})]}),D(s.hindi_name)&&l.language!=="hi"&&e.jsx("p",{className:"text-gray-500 text-sm mb-2",children:s.hindi_name}),D(s.brand_name)&&e.jsxs("p",{className:"text-purple-600 text-sm font-medium mb-2",children:["Brand: ",s.brand_name]}),D(s.description)&&e.jsx("p",{className:"text-gray-600 text-sm mb-3 leading-relaxed",children:s.description}),e.jsx("div",{className:"flex items-center justify-between",children:H(s.price)&&e.jsx("span",{className:"text-xl font-bold text-orange-600",children:H(s.price)})})]})}),e.jsxs("button",{onClick:()=>N(s),disabled:!v.isOpen||w,className:`w-full py-3 px-4 rounded-xl transition-all font-medium flex items-center justify-center space-x-2 ${v.isOpen&&!w?"bg-gradient-to-r from-orange-500 to-red-500 text-white hover:from-orange-600 hover:to-red-600":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:[e.jsx(ee,{size:18}),e.jsx("span",{children:w?"Adding...":v.isOpen?x("restaurant.addToBag"):"Closed"})]})]},s.id))})}),!v.isOpen&&e.jsxs("div",{className:"text-center py-8 bg-red-50 rounded-2xl border border-red-200 mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Restaurant Closed"}),e.jsxs("p",{className:"text-red-600",children:["This restaurant is currently closed. Hours: ",v.formattedHours]})]}),b.length===0&&n&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(B,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:x("restaurant.noItemsFound")}),e.jsx("p",{className:"text-gray-600",children:x("restaurant.tryDifferentSearch")})]})]}),f.length>0&&e.jsx(p.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},className:"fixed bottom-6 right-6 z-50",children:e.jsxs("button",{onClick:()=>k("/bag"),className:"flex items-center space-x-3 bg-green-500 text-white px-6 py-4 rounded-2xl shadow-2xl hover:bg-green-600 transition-all",children:[e.jsx(_,{size:24}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:x("restaurant.viewBag")}),e.jsxs("div",{className:"text-sm opacity-90",children:[f.length," ",x("restaurant.items")]})]})]})})]})},$e=async(a,o,t,u,c)=>{try{return(await F.addShopRating(a,o,t,u,c.trim())).id}catch(n){throw console.error("Error adding review:",n),n}},Te=async(a,o=20)=>{try{return(await F.getShopRatings(a,o)).reviews||[]}catch(t){return console.error("Error fetching shop reviews:",t),[]}},Le=async(a,o)=>{try{const t=await F.getUserRating(a,o);return t.rating?[t.rating]:[]}catch(t){return console.error("Error fetching user reviews:",t),[]}},Ae=async a=>{try{return(await F.getShopRatings(a,1e3)).summary||{averageRating:0,totalReviews:0,ratingDistribution:{5:0,4:0,3:0,2:0,1:0}}}catch(o){return console.error("Error getting review summary:",o),{averageRating:0,totalReviews:0,ratingDistribution:{5:0,4:0,3:0,2:0,1:0}}}},Pe=async(a,o)=>{try{await F.markHelpful(a,o)}catch(t){throw console.error("Error marking review as helpful:",t),t}},Me=({shopId:a,onAddReview:o})=>{const[t,u]=d.useState([]),[c,n]=d.useState(null),[y,g]=d.useState(!0),{user:$}=V();d.useEffect(()=>{f()},[a]);const f=async()=>{try{const[l,m]=await Promise.all([Te(a),Ae(a)]);u(l),n(m)}catch(l){console.error("Error fetching reviews:",l)}finally{g(!1)}},S=async l=>{try{await Pe(a,l),await f()}catch(m){console.error("Error marking review as helpful:",m)}},w=l=>{try{return(l!=null&&l.toDate?l.toDate():new Date(l)).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"})}catch{return"Unknown date"}},j=(l,m=16)=>e.jsx("div",{className:"flex space-x-1",children:[1,2,3,4,5].map(k=>e.jsx(L,{size:m,className:`${k<=l?"text-yellow-400 fill-current":"text-gray-300"}`},k))}),x=(l,m)=>m>0?`${l/m*100}%`:"0%";return y?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[c&&c.totalReviews>0&&e.jsx(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/80 backdrop-blur-md rounded-2xl p-6 border border-white/20 shadow-lg",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-gray-900 mb-2",children:c.averageRating}),e.jsx("div",{className:"flex justify-center mb-2",children:j(c.averageRating,20)}),e.jsxs("p",{className:"text-gray-600",children:["Based on ",c.totalReviews," review",c.totalReviews!==1?"s":""]})]}),e.jsx("div",{className:"space-y-2",children:[5,4,3,2,1].map(l=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{className:"text-sm text-gray-600 w-8",children:[l,"★"]}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-yellow-400 h-2 rounded-full transition-all duration-500",style:{width:x(c.ratingDistribution[l],c.totalReviews)}})}),e.jsx("span",{className:"text-sm text-gray-600 w-8",children:c.ratingDistribution[l]})]},l))})]})}),o&&e.jsx(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center",children:e.jsx("button",{onClick:o,className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all font-medium",children:"⭐ Rate This Shop"})}),e.jsx("div",{className:"space-y-4",children:t.length>0?t.map((l,m)=>e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:m*.1},className:"bg-white/80 backdrop-blur-md rounded-2xl p-6 border border-white/20 shadow-lg",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(de,{size:20,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:l.userName}),e.jsxs("div",{className:"flex items-center space-x-2",children:[j(l.rating),e.jsx("span",{className:"text-sm text-gray-500",children:w(l.createdAt)})]})]})]}),l.isVerified&&e.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium",children:"Verified"})]}),e.jsx("p",{className:"text-gray-700 mb-4 leading-relaxed",children:l.comment}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>S(l.id),className:"flex items-center space-x-2 text-gray-500 hover:text-blue-600 transition-colors",children:[e.jsx(ze,{size:16}),e.jsxs("span",{className:"text-sm",children:["Helpful ",l.helpfulCount?`(${l.helpfulCount})`:""]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[e.jsx(xe,{size:12}),e.jsx("span",{children:w(l.createdAt)})]})]})]},l.id)):e.jsx(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-12",children:e.jsxs("div",{className:"bg-white/70 backdrop-blur-md rounded-2xl p-8 border border-white/20 shadow-lg",children:[e.jsx(L,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Reviews Yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Be the first to review this shop and help others!"}),o&&e.jsx("button",{onClick:o,className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all font-medium",children:"Write First Review"})]})})})]})},De=({shopId:a,shopName:o,isOpen:t,onClose:u,onSuccess:c})=>{var s,r;const[n,y]=d.useState(0),[g,$]=d.useState(0),[f,S]=d.useState(""),[w,j]=d.useState(!1),[x,l]=d.useState(!1),[m,k]=d.useState(!0),[v,z]=d.useState(!1),{user:b,profile:N,needsProfileSetup:R}=V();d.useEffect(()=>{(async()=>{if(!(!b||!t)){k(!0);try{const h=await Le(a,b.uid);if(l(h.length>0),h.length>0){const M=h[0];y(M.rating),S(M.comment||"")}}catch(h){console.error("Error checking existing review:",h)}finally{k(!1)}}})()},[a,b,t]);const A=async i=>{if(i.preventDefault(),!b||!N){C.error("Please sign in to rate this shop");return}if(R){C.error("Please complete your profile setup first");return}if(n===0){C.error("Please select a rating");return}if(f.trim().length<10){C.error("Please write at least 10 characters in your review");return}j(!0);try{await $e(a,b.uid,N.name,n,f),C.success(x?"Review updated successfully!":"Review added successfully!"),y(0),S(""),c()}catch(h){console.error("Error submitting review:",h),C.error(h.message||"Failed to submit review")}finally{j(!1)}},P=i=>{switch(i){case 1:return"Poor - Very unsatisfied";case 2:return"Fair - Below expectations";case 3:return"Good - Meets expectations";case 4:return"Very Good - Above expectations";case 5:return"Excellent - Outstanding service";default:return"Select a rating"}};return t?b?e.jsxs(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:i=>i.target===i.currentTarget&&u(),children:[e.jsxs(p.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"bg-white rounded-2xl shadow-xl border border-gray-200 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:x?"Update Your Review":"Rate This Shop"}),e.jsx("p",{className:"text-gray-600 mt-1",children:o})]}),e.jsx("button",{onClick:u,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(te,{size:20})})]}),m?e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Checking existing review..."})]}):e.jsxs("form",{onSubmit:A,className:"p-6 space-y-6",children:[x&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(L,{size:20,className:"text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900",children:"You've already reviewed this shop"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"You can update your existing review below."})]})]})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-700 mb-4 font-medium",children:"How was your experience?"}),e.jsx("div",{className:"flex justify-center space-x-2 mb-3",children:[1,2,3,4,5].map(i=>e.jsx("button",{type:"button",onClick:()=>y(i),onMouseEnter:()=>$(i),onMouseLeave:()=>$(0),className:"transition-transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded",children:e.jsx(L,{size:36,className:`${i<=(g||n)?"text-yellow-400 fill-current":"text-gray-300"} transition-colors`})},i))}),e.jsx("p",{className:"text-sm font-medium text-gray-700",children:P(g||n)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Review *"}),e.jsx("textarea",{value:f,onChange:i=>S(i.target.value),placeholder:"Share your experience with this shop. What did you like? What could be improved?",rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",maxLength:500,required:!0}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"Minimum 10 characters"}),e.jsxs("span",{children:[f.length,"/500"]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Reviewing as:"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-medium",children:((r=(s=N==null?void 0:N.name)==null?void 0:s.charAt(0))==null?void 0:r.toUpperCase())||"U"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:N==null?void 0:N.name}),e.jsx("p",{className:"text-sm text-gray-600",children:"Verified User"})]})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:u,className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:w||n===0||f.trim().length<10,className:"flex-1 flex items-center justify-center space-x-2 bg-blue-600 text-white px-6 py-3 rounded-xl hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:w?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):e.jsxs(e.Fragment,{children:[e.jsx(me,{size:18}),e.jsx("span",{children:x?"Update Review":"Submit Review"})]})})]})]})]}),e.jsx(Q,{isOpen:v,onClose:()=>z(!1),onSuccess:()=>{z(!1),u()}})]}):e.jsxs(e.Fragment,{children:[e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:i=>i.target===i.currentTarget&&u(),children:e.jsx(p.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"bg-white rounded-2xl shadow-xl border border-gray-200 max-w-md w-full p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(G,{size:32,className:"text-blue-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Authentication Required"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Please sign in to rate and review shops. This helps us maintain authentic reviews from real users."}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:u,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),e.jsx("button",{onClick:()=>{z(!0)},className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-xl hover:bg-blue-700 transition-colors font-medium",children:"Sign In"})]})]})})}),e.jsx(Q,{isOpen:v,onClose:()=>z(!1),onSuccess:()=>{z(!1),u()}})]}):null},Be=({category:a,items:o,onClose:t,shopName:u,shopId:c,shopAddress:n,shopPhone:y})=>{const[g,$]=d.useState(""),[f,S]=d.useState("list"),[w,j]=d.useState("name"),[x,l]=d.useState(!1),[m,k]=d.useState(new Set),[v,z]=d.useState(new Set),{i18n:b}=K(),{user:N}=V(),R=d.useMemo(()=>{let s=o;return g.trim()&&(s=o.filter(r=>r.name&&r.name.toLowerCase().includes(g.toLowerCase())||r.hindi_name&&r.hindi_name.toLowerCase().includes(g.toLowerCase())||r.type&&r.type.toLowerCase().includes(g.toLowerCase())||r.variety&&r.variety.toLowerCase().includes(g.toLowerCase()))),s.sort((r,i)=>{switch(w){case"name":const h=U(r.name,r.hindi_name,b.language)||"",M=U(i.name,i.hindi_name,b.language)||"";return h.localeCompare(M);case"price":const T=r.price||0;return(i.price||0)-T;case"type":return(r.type||"").localeCompare(i.type||"");default:return 0}}),s},[o,g,w,b.language]),A=async s=>{if(!N){C.error("Please login to add items to bag");return}const r=s.id||`${c}-${s.name}`;if(m.has(r)){C.info("Item already added to bag");return}z(i=>new Set(i).add(r));try{await se({itemId:r,itemName:s.name||"Unknown Item",shopId:c,shopName:u,quantity:1,unit:"piece",price:s.price}),k(i=>new Set(i).add(r)),C.success(`${s.name} added to bag!`)}catch(i){console.error("Error adding to bag:",i),C.error("Failed to add item to bag")}finally{z(i=>{const h=new Set(i);return h.delete(r),h})}},P=s=>{const r={grocery:"🛒",kirana:"🏪",food:"🍽️",snacks:"🍿",beverages:"🥤",dairy:"🥛",fruits:"🍎",vegetables:"🥕",spices:"🌶️",oil:"🫒",rice:"🍚",flour:"🌾",sugar:"🧂",tea:"☕",coffee:"☕",biscuits:"🍪",soap:"🧼",shampoo:"🧴",cosmetics:"💄",medicine:"💊",stationery:"📝",toys:"🧸",electronics:"📱",hardware:"🔧",electrical:"💡","mobile accessories":"📱","plastic items":"🥤","frozen items":"🧊",default:"📦"},i=s.toLowerCase();return r[i]||r.default};return e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-end md:items-center justify-center",onClick:t,children:e.jsxs(p.div,{initial:{opacity:0,y:100,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:100,scale:.95},transition:{type:"spring",damping:25,stiffness:300},onClick:s=>s.stopPropagation(),className:"bg-white rounded-t-3xl md:rounded-2xl w-full max-w-4xl max-h-[90vh] md:max-h-[85vh] overflow-hidden shadow-2xl",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 z-10",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 pb-2",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center text-xl shadow-lg",children:P(a)}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 capitalize",children:a}),e.jsxs("p",{className:"text-gray-500 text-sm",children:[u," • ",o.length," items"]})]})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(te,{size:24,className:"text-gray-600"})})]}),e.jsxs("div",{className:"px-4 pb-4 space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search items...",value:g,onChange:s=>$(s.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("select",{value:w,onChange:s=>j(s.target.value),className:"px-3 py-2 bg-white border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"name",children:"Sort by Name"}),e.jsx("option",{value:"price",children:"Sort by Price"}),e.jsx("option",{value:"type",children:"Sort by Type"})]}),e.jsx("button",{onClick:()=>l(!x),className:`p-2 rounded-lg border transition-colors ${x?"bg-blue-50 border-blue-200 text-blue-600":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:e.jsx(he,{size:18})})]}),e.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>S("list"),className:`p-2 rounded-md transition-colors ${f==="list"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:e.jsx(ue,{size:16})}),e.jsx("button",{onClick:()=>S("grid"),className:`p-2 rounded-md transition-colors ${f==="grid"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:e.jsx(pe,{size:16})})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsx("span",{children:g?`${R.length} of ${o.length} items`:`${o.length} items`}),g&&e.jsx("button",{onClick:()=>$(""),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Clear search"})]})]})]}),e.jsx("div",{className:"overflow-y-auto max-h-[calc(90vh-280px)] md:max-h-[calc(85vh-280px)]",children:R.length>0?e.jsx("div",{className:`p-4 ${f==="grid"?"grid grid-cols-2 gap-3":"space-y-3"}`,children:R.map((s,r)=>e.jsx(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.03},className:`bg-white border border-gray-200 rounded-xl hover:shadow-md transition-all cursor-pointer group ${f==="grid"?"p-3":"p-4"}`,children:f==="list"?e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1 group-hover:text-blue-600 transition-colors",children:U(s.name,s.hindi_name,b.language)||"Unnamed Item"}),D(s.hindi_name)&&b.language!=="hi"&&e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:s.hindi_name})]}),s.price&&e.jsx("div",{className:"text-right",children:e.jsx("span",{className:"text-lg font-bold text-green-600",children:H(s.price)})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[D(s.type)&&e.jsxs("span",{className:"inline-flex items-center space-x-1 px-2 py-1 bg-blue-50 text-blue-700 rounded-md text-xs",children:[e.jsx(Ne,{size:12}),e.jsx("span",{children:s.type})]}),D(s.variety)&&e.jsxs("span",{className:"inline-flex items-center space-x-1 px-2 py-1 bg-purple-50 text-purple-700 rounded-md text-xs",children:[e.jsx(ge,{size:12}),e.jsx("span",{children:s.variety})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>A(s),disabled:v.has(s.id||`${c}-${s.name}`)||m.has(s.id||`${c}-${s.name}`),className:`flex-1 py-2 px-3 rounded-lg transition-colors flex items-center justify-center space-x-1 text-sm ${m.has(s.id||`${c}-${s.name}`)?"bg-green-600 text-white":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:v.has(s.id||`${c}-${s.name}`)?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):m.has(s.id||`${c}-${s.name}`)?e.jsxs(e.Fragment,{children:[e.jsx(be,{size:14}),e.jsx("span",{children:"Added"})]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{size:14}),e.jsx("span",{children:"Add to Bag"})]})}),e.jsx("button",{className:"p-2 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:e.jsx(ae,{size:16,className:"text-gray-600"})})]})]})}):e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-100 to-purple-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:e.jsx(q,{size:20,className:"text-blue-600"})}),e.jsx("h3",{className:"font-medium text-gray-900 mb-1 text-sm group-hover:text-blue-600 transition-colors line-clamp-2",children:U(s.name,s.hindi_name,b.language)||"Unnamed Item"}),s.price&&e.jsx("p",{className:"text-green-600 font-bold text-sm mb-2",children:H(s.price)}),D(s.type)&&e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:s.type}),e.jsx("button",{onClick:()=>A(s),disabled:v.has(s.id||`${c}-${s.name}`)||m.has(s.id||`${c}-${s.name}`),className:`w-full py-2 px-2 rounded-lg transition-colors text-xs ${m.has(s.id||`${c}-${s.name}`)?"bg-green-600 text-white":"bg-blue-600 text-white hover:bg-blue-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:v.has(s.id||`${c}-${s.name}`)?e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mx-auto"}):m.has(s.id||`${c}-${s.name}`)?"Added":"Add to Bag"})]})},s.id))}):e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-16 px-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(B,{size:32,className:"text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:g?"No items found":"No items available"}),e.jsx("p",{className:"text-gray-600 mb-6 max-w-sm mx-auto",children:g?"Try adjusting your search terms or browse other categories":"This category is currently empty. Check back later for new items!"}),g&&e.jsx("button",{onClick:()=>$(""),className:"bg-blue-600 text-white px-6 py-3 rounded-xl hover:bg-blue-700 transition-colors font-medium",children:"Clear Search"})]})}),R.length>0&&e.jsx("div",{className:"sticky bottom-0 bg-white border-t border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:R.length})," items in ",a]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors text-sm",children:"Select All"}),e.jsx("button",{className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:"Add to Bag"})]})]})})]})})},Ee=({searchQuery:a,onSearchChange:o,sortBy:t,onSortChange:u,totalCategories:c,filteredCount:n})=>e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white/70 backdrop-blur-md rounded-2xl p-4 border border-white/20 shadow-lg",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx(B,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search categories, items, types...",value:a,onChange:y=>o(y.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white/80 placeholder-gray-500"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Se,{className:"h-4 w-4 text-gray-500"}),e.jsxs("select",{value:t,onChange:y=>u(y.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white/80 text-sm",children:[e.jsx("option",{value:"name",children:"Sort by Name"}),e.jsx("option",{value:"count",children:"Sort by Item Count"}),e.jsx("option",{value:"az",children:"A to Z"}),e.jsx("option",{value:"za",children:"Z to A"})]})]}),e.jsx("div",{className:"text-sm text-gray-600",children:a?e.jsxs("span",{children:[n," of ",c," categories"]}):e.jsxs("span",{children:[c," categories"]})})]}),a&&e.jsx(p.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-blue-600 font-medium",children:['Searching for: "',a,'"']}),e.jsx("button",{onClick:()=>o(""),className:"text-xs text-gray-500 hover:text-red-500 transition-colors",children:"Clear"})]})})]}),Ue=({shop:a})=>{const o=J(a.openingTime||"",a.closingTime||""),t=()=>{const c=`Hi ${a.shopName}, I'm interested in your services. Can you please share more details? - From SamanKhojo`;return`https://wa.me/${a.phone.replace(/[^0-9]/g,"")}?text=${encodeURIComponent(c)}`},u=c=>{const n=c.toLowerCase();return n.includes("hair")||n.includes("cut")?"✂️":n.includes("massage")||n.includes("spa")?"💆":n.includes("repair")||n.includes("fix")?"🔧":n.includes("clean")?"🧽":n.includes("beauty")||n.includes("facial")?"💄":n.includes("mobile")||n.includes("phone")?"📱":n.includes("computer")||n.includes("laptop")?"💻":n.includes("delivery")||n.includes("transport")?"🚚":n.includes("tutor")||n.includes("teach")?"📚":n.includes("doctor")||n.includes("medical")?"👨‍⚕️":"🔧"};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-blue-50 to-indigo-50",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"h-80 overflow-hidden",children:[e.jsx("img",{src:a.imageUrl||"https://images.pexels.com/photos/3184291/pexels-photo-3184291.jpeg?auto=compress&cs=tinysrgb&w=800",alt:a.shopName,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-black/30 to-transparent"})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-6 text-white",children:e.jsxs(p.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-16 h-16 bg-white/20 backdrop-blur-md rounded-2xl flex items-center justify-center text-2xl",children:"🔧"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:a.shopName}),e.jsx("p",{className:"text-purple-200 text-lg",children:"Professional Services"})]})]}),e.jsxs("div",{className:"flex items-center space-x-6 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{size:16}),e.jsx("span",{className:o.isOpen?"text-green-200":"text-red-200",children:o.status})]}),a.averageRating&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{size:16,className:"fill-current text-yellow-400"}),e.jsxs("span",{children:[a.averageRating," Rating"]})]}),a.isVerified&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{size:16}),e.jsx("span",{children:"Verified"})]})]})]})})]}),e.jsx("div",{className:"px-4 py-8",children:e.jsx(p.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.2},className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-white/90 backdrop-blur-xl rounded-3xl p-8 shadow-2xl border border-white/50",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Our Services"}),e.jsx("p",{className:"text-gray-600",children:"Professional quality services you can trust"})]}),a.serviceDetails&&a.serviceDetails.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:a.serviceDetails.map((c,n)=>e.jsxs(p.div,{initial:{opacity:0,x:n%2===0?-30:30},animate:{opacity:1,x:0},transition:{delay:.3+n*.1},className:"flex items-start space-x-4 p-6 bg-gradient-to-br from-purple-50 to-blue-50 rounded-2xl border border-purple-200",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-blue-600 rounded-xl flex items-center justify-center text-white text-xl shadow-lg",children:u(c)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-2",children:["Service ",n+1]}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:c})]})]},n))}):e.jsxs("div",{className:"text-center py-12 mb-8",children:[e.jsx("div",{className:"w-20 h-20 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-3xl",children:"🔧"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Professional Services Available"}),e.jsx("p",{className:"text-gray-600 max-w-md mx-auto",children:"Contact us directly to learn about our full range of professional services and get personalized assistance."})]}),e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-blue-50 rounded-2xl p-6 border border-gray-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4 text-center",children:"Get in Touch"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(X,{size:18,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Call Us"}),e.jsx("p",{className:"text-sm text-gray-600",children:a.phone})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(W,{size:18,className:"text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Visit Us"}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:a.address})]})]}),a.openingTime&&a.closingTime&&e.jsxs("div",{className:"flex items-center space-x-3 md:col-span-2",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(I,{size:18,className:"text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Business Hours"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[Y(a.openingTime)," - ",Y(a.closingTime)]})]})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("a",{href:t(),target:"_blank",rel:"noopener noreferrer",className:"flex-1 flex items-center justify-center space-x-2 bg-gradient-to-r from-green-500 to-green-600 text-white py-4 px-6 rounded-xl hover:from-green-600 hover:to-green-700 transition-all font-medium shadow-lg",children:[e.jsx(_,{size:20}),e.jsx("span",{children:"Contact via WhatsApp"})]}),e.jsxs("a",{href:a.mapLink||`https://maps.google.com/?q=${encodeURIComponent(a.address)}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center space-x-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white py-4 px-6 rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all font-medium shadow-lg",children:[e.jsx(re,{size:20}),e.jsx("span",{children:"Get Directions"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-6",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-xl border border-green-200",children:[e.jsx(ie,{size:24,className:"text-green-600 mx-auto mb-2"}),e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Verified Service"})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-xl border border-blue-200",children:[e.jsx(ne,{size:24,className:"text-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Quality Assured"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-xl border border-purple-200",children:[e.jsx(L,{size:24,className:"text-purple-600 mx-auto mb-2"}),e.jsx("p",{className:"text-sm font-medium text-purple-800",children:"Customer Rated"})]})]})]})})})]})},We=()=>{const{id:a}=ve(),o=le(),[t,u]=d.useState(null),[c,n]=d.useState({}),[y,g]=d.useState([]),[$,f]=d.useState(!0),[S,w]=d.useState(null),[j,x]=d.useState(""),[l,m]=d.useState("name"),[k,v]=d.useState([]),[z,b]=d.useState(!1),[N,R]=d.useState("items"),A=r=>{const i={grocery:"🛒",kirana:"🏪",food:"🍽️",snacks:"🍿",beverages:"🥤",dairy:"🥛",fruits:"🍎",vegetables:"🥕",spices:"🌶️",oil:"🫒",rice:"🍚",flour:"🌾",sugar:"🧂",tea:"☕",coffee:"☕",biscuits:"🍪",soap:"🧼",shampoo:"🧴",cosmetics:"💄",medicine:"💊",stationery:"📝",toys:"🧸",electronics:"📱",hardware:"🔧",electrical:"💡","mobile accessories":"📱","plastic items":"🥤","frozen items":"🧊",default:"📦"},h=r.toLowerCase();return i[h]||i.default};d.useEffect(()=>{(async()=>{if(a){f(!0);try{const{shop:i,groupedItems:h,categories:M}=await ye(a);if(!i){C.error("Shop not found"),o("/shops");return}u(i),n(h);const T=M.map(E=>({name:E.name,items:E.items,icon:A(E.name),count:E.count}));g(T),v(T)}catch(i){console.error("Error fetching shop data:",i),C.error("Failed to load shop details")}finally{f(!1)}}})()},[a,o]),d.useEffect(()=>{let r=y;j.trim()&&(r=y.filter(i=>{const h=i.name.toLowerCase().includes(j.toLowerCase()),M=i.items.some(T=>T.name&&T.name.toLowerCase().includes(j.toLowerCase())||T.type&&T.type.toLowerCase().includes(j.toLowerCase())||T.variety&&T.variety.toLowerCase().includes(j.toLowerCase()));return h||M})),r.sort((i,h)=>{switch(l){case"name":return i.name.localeCompare(h.name);case"count":return h.count-i.count;case"az":return i.name.localeCompare(h.name);case"za":return h.name.localeCompare(i.name);default:return 0}}),v(r)},[j,l,y]);const P=r=>{w(S===r?null:r)},s=()=>{if(!t||!t.phone)return"#";const r=`Hi, I found your shop on SamanKhojo. I'm interested in your products.

📍 Address: ${t.address}
📞 Phone: ${t.phone}

- From SamanKhojo`;return`https://wa.me/${t.phone.replace(/[^0-9]/g,"")}?text=${encodeURIComponent(r)}`};return $?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:e.jsx(p.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center",children:e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg border border-gray-200",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Loading Shop Details"}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch the shop information..."})]})})}):t?t.shopType==="service"&&t.serviceDetails&&t.serviceDetails.length>0?e.jsx(Ue,{shop:t}):["restaurant","cafe","hotel"].includes(t.type||"")?e.jsx(Re,{shop:t}):e.jsxs("div",{className:"min-h-screen bg-gray-50 mobile-safe-area",children:[e.jsx("div",{className:"sticky top-0 z-40 bg-white shadow-sm border-b",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>o("/shops"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(Z,{size:20,className:"text-gray-700"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-semibold text-gray-900 truncate max-w-48",children:t.shopName}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[t.averageRating&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(L,{size:12,className:"fill-current text-yellow-500"}),e.jsx("span",{children:t.averageRating})]}),e.jsx("span",{children:"•"}),e.jsx("span",{className:"capitalize",children:t.type})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(ae,{size:20,className:"text-gray-600"})}),e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(ke,{size:20,className:"text-gray-600"})})]})]})}),e.jsxs("div",{className:"bg-white",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"h-48 bg-gradient-to-r from-blue-500 to-purple-600 relative overflow-hidden",children:[t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:t.shopName,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-white",children:[e.jsx(q,{size:48,className:"mx-auto mb-2 opacity-80"}),e.jsx("p",{className:"text-lg font-medium",children:t.shopName})]})}),e.jsx("div",{className:"absolute inset-0 bg-black/20"}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${t.isOpen?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:t.isOpen?"Open":"Closed"})}),t.isFeatured&&e.jsx("div",{className:"absolute top-4 left-4",children:e.jsxs("div",{className:"bg-orange-500 text-white px-3 py-1 rounded-full text-sm font-medium flex items-center space-x-1",children:[e.jsx(ne,{size:14}),e.jsx("span",{children:"Featured"})]})})]}),e.jsx("div",{className:"px-4 py-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4 -mt-8 relative z-10",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-1",children:t.shopName}),e.jsx("p",{className:"text-gray-600 text-sm mb-2",children:t.ownerName&&`By ${t.ownerName}`}),e.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[t.averageRating&&e.jsxs("div",{className:"flex items-center space-x-1 bg-green-600 text-white px-2 py-1 rounded",children:[e.jsx(L,{size:12,className:"fill-current"}),e.jsx("span",{className:"text-sm font-medium",children:t.averageRating})]}),t.totalReviews&&e.jsxs("span",{className:"text-sm text-gray-600",children:[t.totalReviews," reviews"]}),t.isVerified&&e.jsxs("div",{className:"flex items-center space-x-1 text-blue-600",children:[e.jsx(ie,{size:14}),e.jsx("span",{className:"text-sm",children:"Verified"})]})]}),e.jsxs("div",{className:"flex items-start space-x-2 text-gray-600 mb-3",children:[e.jsx(W,{size:16,className:"mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm",children:t.address})]}),t.openingTime&&t.closingTime&&e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600 mb-3",children:[e.jsx(I,{size:16}),e.jsxs("span",{className:"text-sm",children:[t.openingTime," - ",t.closingTime]})]}),e.jsx("div",{className:"flex items-center space-x-2 mb-3",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${t.shopType==="product"?"bg-blue-100 text-blue-800":t.shopType==="menu"?"bg-orange-100 text-orange-800":"bg-purple-100 text-purple-800"}`,children:t.shopType==="product"?"🛍️ Product Store":t.shopType==="menu"?"🍽️ Restaurant/Menu":"🔧 Service Provider"})}),t.shopType==="service"&&t.serviceDetails&&t.serviceDetails.length>0&&e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3 mb-3",children:[e.jsxs("h4",{className:"flex items-center space-x-2 text-sm font-semibold text-purple-800 mb-2",children:[e.jsx("span",{children:"🔧"}),e.jsx("span",{children:"Our Services"})]}),e.jsx("ul",{className:"space-y-1",children:t.serviceDetails.map((r,i)=>e.jsxs("li",{className:"flex items-start space-x-2 text-sm text-purple-700",children:[e.jsx("span",{className:"text-purple-500 mt-1",children:"•"}),e.jsx("span",{children:r})]},i))})]})]})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("a",{href:s(),target:"_blank",rel:"noopener noreferrer",className:"flex-1 bg-green-600 text-white py-3 px-4 rounded-lg font-medium text-center hover:bg-green-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(_,{size:18}),e.jsx("span",{children:"Contact"})]}),e.jsxs("button",{className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(fe,{size:18}),e.jsx("span",{children:"Quick Order"})]}),e.jsx("a",{href:t.mapLink||`https://maps.google.com/?q=${encodeURIComponent(t.address)}`,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center",children:e.jsx(re,{size:18,className:"text-gray-600"})})]})]})})]}),e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 text-center",children:[e.jsx(G,{size:20,className:"text-green-600 mx-auto mb-1"}),e.jsx("p",{className:"text-xs text-green-700 font-medium",children:"Safe & Secure"})]}),e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3 text-center",children:[e.jsx(je,{size:20,className:"text-orange-600 mx-auto mb-1"}),e.jsx("p",{className:"text-xs text-orange-700 font-medium",children:"Best Prices"})]})]})})]}),e.jsx("div",{className:"sticky top-16 z-30 bg-white border-b",children:e.jsxs("div",{className:"flex",children:[e.jsx("button",{onClick:()=>R("items"),className:`flex-1 py-4 px-4 font-medium text-center border-b-2 transition-colors ${N==="items"?"border-blue-600 text-blue-600 bg-blue-50":"border-transparent text-gray-600 hover:text-gray-900"}`,children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(q,{size:18}),e.jsxs("span",{children:["Products (",y.length,")"]})]})}),e.jsx("button",{onClick:()=>R("reviews"),className:`flex-1 py-4 px-4 font-medium text-center border-b-2 transition-colors ${N==="reviews"?"border-blue-600 text-blue-600 bg-blue-50":"border-transparent text-gray-600 hover:text-gray-900"}`,children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(L,{size:18}),e.jsx("span",{children:"Reviews"})]})})]})}),e.jsx("div",{className:"pb-24 md:pb-20",children:N==="items"?e.jsxs("div",{children:[e.jsx("div",{className:"bg-white border-b px-4 py-3",children:e.jsx(Ee,{searchQuery:j,onSearchChange:x,sortBy:l,onSortChange:m,totalCategories:y.length,filteredCount:k.length})}),e.jsx("div",{className:"px-4 py-4",children:k.length>0?e.jsx("div",{className:"grid grid-cols-2 gap-3",children:k.map((r,i)=>e.jsx(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:i*.05},onClick:()=>P(r.name),className:"bg-white rounded-lg border shadow-sm hover:shadow-md transition-all cursor-pointer overflow-hidden",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("div",{className:"text-2xl",children:r.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-gray-900 text-sm",children:r.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[r.count," items"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"View All"}),e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Z,{size:12,className:"text-blue-600 rotate-180"})})]})]})},r.name))}):e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-sm border",children:[e.jsx(B,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No categories found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:j?"Try adjusting your search terms":"This shop has no items yet"}),j&&e.jsx("button",{onClick:()=>x(""),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Clear Search"})]})})})]}):e.jsx("div",{className:"bg-white",children:e.jsx(Me,{shopId:t.id,onAddReview:()=>b(!0)})})}),e.jsx(ce,{children:S&&e.jsx(Be,{category:S,items:c[S]||[],onClose:()=>w(null),shopName:t.shopName,shopId:t.id,shopAddress:t.address,shopPhone:t.phone})}),e.jsxs("div",{className:"fixed bottom-24 md:bottom-20 right-6 flex flex-col space-y-3 z-50",children:[e.jsxs(p.button,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:.3},onClick:()=>o("/bag"),className:"bg-green-600 text-white p-4 rounded-full shadow-lg hover:bg-green-700 transition-all group",title:"View Bag",children:[e.jsx(ee,{size:24}),e.jsx("span",{className:"absolute right-full mr-3 top-1/2 transform -translate-y-1/2 bg-gray-900 text-white px-2 py-1 rounded text-sm whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity",children:"View Bag"})]}),e.jsxs(p.button,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:.5},onClick:()=>b(!0),className:"bg-blue-600 text-white p-4 rounded-full shadow-lg hover:bg-blue-700 transition-all group",title:"Rate this Shop",children:[e.jsx(L,{size:24}),e.jsx("span",{className:"absolute right-full mr-3 top-1/2 transform -translate-y-1/2 bg-gray-900 text-white px-2 py-1 rounded text-sm whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity",children:"Rate Shop"})]})]}),e.jsx(De,{shopId:t.id,shopName:t.shopName,isOpen:z,onClose:()=>b(!1),onSuccess:()=>{b(!1),N==="reviews"&&window.location.reload()}})]}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Shop Not Found"}),e.jsx("button",{onClick:()=>o("/shops"),className:"bg-blue-600 text-white px-6 py-3 rounded-xl hover:bg-blue-700 transition-colors",children:"Back to Shops"})]})})};export{We as default};
